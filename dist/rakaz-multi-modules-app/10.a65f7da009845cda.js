"use strict";(self.webpackChunkrakaz_multi_modules_app=self.webpackChunkrakaz_multi_modules_app||[]).push([[10],{5010:(Ht,N,p)=>{p.r(N),p.d(N,{CustomerAdminModule:()=>Xt});var m=p(177),E=p(749),e=p(8699);let R=(()=>{class i{constructor(){this.selectedHeader={link:"",header:""}}ngOnInit(){}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-header"]],inputs:{selectedHeader:"selectedHeader"},decls:3,vars:1,consts:[[1,"headingBlock"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"h1"),e.EFF(2),e.k0s()()),2&s&&(e.R7$(2),e.JRh(o.selectedHeader.header))}})}}return i})();var r=p(4341),d=p(2237),$=p(5312),j=p(1626);let _=(()=>{class i{constructor(t){this.http=t,this.apiUrl=$.c.apiUrl}createCustomerType(t){return this.http.post(`${this.apiUrl}customer-types`,t)}getCustomerTypes(){return this.http.get(`${this.apiUrl}customer-types`)}getCustomerTypeById(t){return this.http.get(`${this.apiUrl}customer-types/${t}`)}updateCustomerType(t,s){return this.http.put(`${this.apiUrl}customer-types/${t}`,s)}deleteCustomerType(t){return this.http.delete(`${this.apiUrl}customer-types`,{body:{ids:t}})}getCountries(){return this.http.get(`${this.apiUrl}countries`)}getStates(t){return this.http.get(`${this.apiUrl}states/country/${t}`)}getCities(t){return this.http.get(`${this.apiUrl}cities/state/${t}`)}getCurrencies(){return this.http.get(`${this.apiUrl}currencies`)}createCustomer(t){return this.http.post(`${this.apiUrl}customers`,t)}getCustomers(t){return this.http.post(`${this.apiUrl}getcustomers`,t)}getCustomerById(t){return this.http.get(`${this.apiUrl}customers/${t}`)}updateCustomer(t,s){return this.http.put(`${this.apiUrl}customers/${t}`,s)}deleteCustomer(t){return this.http.delete(`${this.apiUrl}customers/${t}`)}createSubscription(t){return this.http.post(`${this.apiUrl}subscriptions`,t)}getSubscriptions(t){return this.http.post(`${this.apiUrl}get-subscriptions`,t)}getSubscriptionById(t){return this.http.get(`${this.apiUrl}subscriptions/${t}`)}updateSubscription(t,s){return this.http.put(`${this.apiUrl}subscriptions/${t}`,s)}deleteSubscription(t){return this.http.delete(`${this.apiUrl}subscriptions`,{body:t})}createSensorGroup(t){return this.http.post(`${this.apiUrl}sensors-group`,t)}getSensorGroups(t){return this.http.post(`${this.apiUrl}get-sensors-group`,t)}getSensorGroupById(t){return this.http.get(`${this.apiUrl}sensors-group/${t}`)}updateSensorGroup(t,s){return this.http.put(`${this.apiUrl}sensors-group/${t}`,s)}deleteSensorGroup(t,s){return this.http.delete(`${this.apiUrl}sensors-group/${s}`,{body:t})}getSensorGroupParameters(t){return this.http.post(`${this.apiUrl}sensor-group-parameters`,{organization_id:t})}getAllCustomersForSensorGroupMapping(t){return this.http.post(`${this.apiUrl}sensor-group-mappings/customers`,t)}getDeviceMappingDetails(t){return this.http.get(`${this.apiUrl}devices/mapping-list/${t}`)}createSensorGroupMapping(t){return this.http.post(`${this.apiUrl}sensor-group-mappings`,t)}getSensorGroupMappings(t){return this.http.post(`${this.apiUrl}get-sensor-group-mappings`,t)}getSensorGroupMappingById(t){return this.http.get(`${this.apiUrl}sensor-group-mappings/${t}`)}updateSensorGroupMapping(t,s){return this.http.put(`${this.apiUrl}sensor-group-mappings/${t}`,s)}deleteSensorGroupMapping(t,s){return this.http.delete(`${this.apiUrl}sensor-group-mappings/${t}`,s)}getCustomerAdminById(t){return this.http.get(`${this.apiUrl}customer-admins/${t}`)}changePassword(t,s){return this.http.put(`${this.apiUrl}users/${t}/change-password`,s)}updateCustomerAdminProfile(t,s){return this.http.put(`${this.apiUrl}customer-admins/profile/${t}`,s)}static{this.\u0275fac=function(s){return new(s||i)(e.KVO(j.Qq))}}static{this.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var F=p(5889),b=p(9045),h=p(1358),g=p(144);function U(i,l){1&i&&(e.j41(0,"div",7),e.EFF(1," Customer Admin Type is required. "),e.k0s())}const L=function(i){return{"is-invalid":i}},z=function(){return{standalone:!0}};let Y=(()=>{class i{constructor(t,s,o,n,a){this.fb=t,this.activeModal=s,this.customerAdminService=o,this.toastService=n,this.appStateService=a,this.customerAdminTypes=[],this.units=[],this.selectedCustomerAdminTypes=[],this.selectedUnits=[],this.userId=0}ngOnInit(){this.customerAdminTypeForm=this.fb.group({customerAdminType:["",r.k0.required]}),this.unitForm=this.fb.group({unit:["",r.k0.required]}),this.userId=this.appStateService.getUser().user.id,this.getCustomerAdminTypes()}getCustomerAdminTypes(){this.customerAdminService.getCustomerTypes().subscribe({next:t=>{t.success?this.customerAdminTypes=Array.isArray(t.data)?t.data.map(s=>({id:s.id,customer_type:s.customer_type})):[]:(this.toastService.showError("Customer Admin Type fetching failed"),this.customerAdminTypes=[])},error:t=>{console.error("Error fetching customer admin types:",t),this.toastService.showError("Customer Admin Type fetching failed"),this.customerAdminTypes=[]}})}addCustomerAdminType(){const t=this.customerAdminTypeForm.get("customerAdminType");if(t?.markAsTouched(),t?.invalid)return;const s=t?.value.trim();s&&!this.customerAdminTypes.includes(s)?(this.customerAdminService.createCustomerType({customer_type:s,created_by:this.userId}).subscribe(o=>{console.log(o),o.success?(this.customerAdminTypes=[...this.customerAdminTypes,{id:o.data.id,customer_type:s}],this.toastService.showSuccess("Customer Admin Type created successfully")):this.toastService.showError("Customer Admin Type creation failed")}),t?.reset()):this.toastService.showError("Customer Admin Type already exists")}deleteSelectedCustomerTypes(){const t=this.selectedCustomerAdminTypes;0!==t.length?this.customerAdminService.deleteCustomerType(t).subscribe(s=>{s.success?(this.toastService.showSuccess("Customer Admin Types deleted successfully"),this.customerAdminTypes=this.customerAdminTypes.filter(o=>!t.includes(o.id)),this.selectedCustomerAdminTypes=this.selectedCustomerAdminTypes.filter(o=>!t.includes(o))):this.toastService.showError("Customer Admin Types deletion failed")}):this.toastService.showError("Please select at least one item to delete")}close(){this.activeModal.dismiss()}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(r.ok),e.rXU(d.Lw),e.rXU(_),e.rXU(F.f),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-configuration-form"]],decls:23,vars:10,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"form-group"],[1,"text-danger"],[1,"d-flex","gap-2"],["type","text","formControlName","customerAdminType","placeholder","Enter Customer Admin Type",1,"form-control",3,"ngClass"],["type","button",1,"btn","btn-sm","btn-primary","btn-custom-height",3,"click"],["class","text-danger",4,"ngIf"],[1,"mt-2"],["bindLabel","customer_type","bindValue","id","placeholder","Select to delete",1,"custom-currency-select","ng-select-width-100",3,"items","ngModel","ngModelOptions","multiple","ngModelChange"],["type","button",1,"btn","btn-danger","btn-no-bg","d-flex","align-items-center","justify-content-center","btn-custom-height",3,"click"],[1,"bi","bi-trash"]],template:function(s,o){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3,"Configuration"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.close()}),e.k0s()(),e.j41(5,"div",4)(6,"form",5)(7,"div",6)(8,"label"),e.EFF(9,"Customer Admin Type "),e.j41(10,"span",7),e.EFF(11,"*"),e.k0s()(),e.j41(12,"div",8),e.nrm(13,"input",9),e.j41(14,"button",10),e.bIt("click",function(){return o.addCustomerAdminType()}),e.EFF(15," Add "),e.k0s()(),e.DNE(16,U,2,0,"div",11),e.j41(17,"label",12),e.EFF(18,"Delete Customer Admin Type"),e.k0s(),e.j41(19,"div",8)(20,"ng-select",13),e.bIt("ngModelChange",function(a){return o.selectedCustomerAdminTypes=a}),e.k0s(),e.j41(21,"button",14),e.bIt("click",function(){return o.deleteSelectedCustomerTypes()}),e.nrm(22,"i",15),e.k0s()()()()()()),2&s){let n,a;e.R7$(6),e.Y8G("formGroup",o.customerAdminTypeForm),e.R7$(7),e.Y8G("ngClass",e.eq3(7,L,(null==(n=o.customerAdminTypeForm.get("customerAdminType"))?null:n.invalid)&&(null==(n=o.customerAdminTypeForm.get("customerAdminType"))?null:n.touched))),e.R7$(3),e.Y8G("ngIf",(null==(a=o.customerAdminTypeForm.get("customerAdminType"))?null:a.invalid)&&(null==(a=o.customerAdminTypeForm.get("customerAdminType"))?null:a.touched)),e.R7$(4),e.Y8G("items",o.customerAdminTypes)("ngModel",o.selectedCustomerAdminTypes)("ngModelOptions",e.lJ4(9,z))("multiple",!0)}},dependencies:[m.YU,m.bT,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,h.ZP,g.vr,r.vS]})}}return i})();var G=p(3664);function q(i,l){if(1&i){const t=e.RV6();e.j41(0,"a",10),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.navigateTo(n))}),e.nrm(1,"i"),e.k0s()}if(2&i){const t=l.$implicit;e.Y8G("ngbTooltip",t.tooltip)("ngClass",t.active),e.R7$(1),e.HbH(t.icon)}}let O=(()=>{class i{constructor(t,s,o){this.modalService=t,this.authService=s,this.router=o,this.selectedComponent={link:"",header:""},this.linkSelected=new e.bkB,this.activeState="",this.navLinks=[{icon:"bi-speedometer2",tooltip:"Dashboard",link:"dashboard",header:"Dashboard",active:"active"},{icon:"bi-people",tooltip:"Customer Details",link:"customer-details",header:"Customer Details",active:"inactive"},{icon:"bi-sliders",tooltip:"Sensor Group Management",link:"sensor-group",header:"Sensor Group Management",active:"inactive"},{icon:"bi-diagram-3",tooltip:"Sensor Group Mapping",link:"sensor-grouping",header:"Sensor Group Mapping",active:"inactive"},{icon:"bi-journal-check",tooltip:"Subscription",link:"subscriptions",header:"Subscription",active:"inactive"},{icon:"bi-credit-card-2-front",tooltip:"Payment Details",link:"payment-details",header:"Payment Details",active:"inactive"},{icon:"bi-bar-chart-line",tooltip:"Reports",link:"reports",header:"Reports",active:"inactive"}],this.bottomNavLinks=[{icon:"bi-gear",tooltip:"Configuration",link:"configuration",active:"inactive",header:"Configuration",isRouterLink:!1},{icon:"bi-bell",tooltip:"Notification",link:"notification",active:"inactive",header:"Notification",isRouterLink:!0},{icon:"bi-person-circle",tooltip:"Profile",link:"profile",active:"inactive",header:"Profile",isRouterLink:!0}]}ngOnInit(){this.selectedComponent=this.navLinks[0]}navigateTo(t){console.log(t),this.linkSelected.emit({link:t.link,header:t.header}),this.selectedComponent=t,this.navLinks.forEach(s=>{s.active="inactive",s.link===t.link&&(s.active="active")})}openConfigurationModal(){document.body.classList.add("modal-open-scroll-lock"),this.modalService.open(Y,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class"}).result.then(s=>{console.log("Configuration modal closed with result:",s)}).catch(s=>{console.error("Configuration modal closed with error:",s)})}logout(){this.authService.logout(),this.router.navigate(["/login"])}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(G.u),e.rXU(E.Ix))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-sidenav"]],outputs:{linkSelected:"linkSelected"},decls:10,vars:1,consts:[[1,"sidebar"],[1,"sidebar-logo","text-center"],["src","assets/logo-icon.svg","width","40","alt","Logo"],[1,"nav-icons","flex-grow-1"],["ngbTooltip","Customer Admin Details","tooltipClass","tooltipCustom","container","body","placement","right","class","nav-icon",3,"ngbTooltip","ngClass","click",4,"ngFor","ngForOf"],[1,"nav-icons-bottom"],["ngbTooltip","Configuration","tooltipClass","tooltipCustom","container","body","placement","right","routerLinkActive","active",1,"nav-icon",3,"click"],[1,"bi","bi-tools"],["ngbTooltip","Profile","tooltipClass","tooltipCustom","container","body","placement","right","routerLinkActive","active",1,"nav-icon",3,"click"],[1,"bi","bi-person-circle"],["ngbTooltip","Customer Admin Details","tooltipClass","tooltipCustom","container","body","placement","right",1,"nav-icon",3,"ngbTooltip","ngClass","click"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1),e.nrm(2,"img",2),e.k0s(),e.j41(3,"div",3),e.DNE(4,q,2,4,"a",4),e.k0s(),e.j41(5,"div",5)(6,"a",6),e.bIt("click",function(){return o.openConfigurationModal()}),e.nrm(7,"i",7),e.k0s(),e.j41(8,"a",8),e.bIt("click",function(){return o.navigateTo(o.bottomNavLinks[2])}),e.nrm(9,"i",9),e.k0s()()()),2&s&&(e.R7$(4),e.Y8G("ngForOf",o.navLinks))},dependencies:[m.YU,m.Sq,E.wQ,d.md]})}}return i})();function x(i,l){if(1&i&&(e.nrm(0,"input",47),e.EFF(1)),2&i){const t=l.item,s=e.XpG();e.Y8G("checked",null==s.selectedSensorTypes?null:s.selectedSensorTypes.includes(t.id)),e.R7$(1),e.SpI(" ",t.name," ")}}function B(i,l){if(1&i&&(e.nrm(0,"input",47),e.EFF(1)),2&i){const t=l.item,s=e.XpG();e.Y8G("checked",null==s.selectedCustomers?null:s.selectedCustomers.includes(t.id)),e.R7$(1),e.SpI(" ",t.name," ")}}function V(i,l){if(1&i&&(e.j41(0,"strong"),e.EFF(1),e.k0s()),2&i){const t=l.item;e.R7$(1),e.JRh(t.group)}}function X(i,l){if(1&i&&(e.nrm(0,"input",47),e.EFF(1)),2&i){const t=l.item,s=e.XpG();e.Y8G("checked",null==s.selectedDeviceIds?null:s.selectedDeviceIds.includes(t.id)),e.R7$(1),e.SpI(" ",t.name," ")}}let H=(()=>{class i{constructor(){this.sensorTypes=[{id:1,name:"Air"},{id:2,name:"Water"},{id:3,name:"Temperature"},{id:4,name:"Humidity"}],this.selectedSensorTypes=[1],this.customers=[{id:0,name:"All"},{id:1,name:"Fahed"},{id:2,name:"Ahmed"},{id:3,name:"Mohamed"},{id:4,name:"Ali"},{id:5,name:"Omar"},{id:6,name:"Yousef"},{id:7,name:"Ahmed"}],this.selectedCustomers=[1],this.groupedDeviceIds=[{id:2324,name:"2324",group:"Group A"},{id:2325,name:"2325",group:"Group A"},{id:3001,name:"3001",group:"Group B"},{id:3002,name:"3002",group:"Group B"},{id:4001,name:"4001",group:"Group C"}],this.selectedDeviceIds=[],this.tipContent="I am a tooltip"}ngOnInit(){}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-dashboard"]],decls:226,vars:17,consts:[[1,"headSection","mt-2"],[1,"leftHeadSection"],[1,"filterDateReport","custom-filter-section"],[1,"col-md-2"],["bindLabel","name","bindValue","id","placeholder","Select Sensor Type",1,"ng-select-checkbox","custom-ng-select","isMultiSelect",3,"items","multiple","closeOnSelect","searchable","ngModel","ngModelChange"],["ng-option-tmp",""],["bindLabel","name","bindValue","id","placeholder","Select Customer",1,"ng-select-checkbox","custom-ng-select","isMultiSelect",3,"items","multiple","closeOnSelect","searchable","ngModel","ngModelChange"],["bindLabel","name","bindValue","id","groupBy","group","placeholder","Select Device Id",1,"ng-select-checkbox","custom-ng-select","isMultiSelect",3,"items","multiple","closeOnSelect","searchable","ngModel","ngModelChange"],["ng-optgroup-tmp",""],[1,"input-group"],["placeholder","Start Date","name","dp","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],["d","ngbDatepicker"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["placeholder","End Date","name","dp","ngbDatepicker","",1,"form-control",3,"ngModel","ngModelChange"],[1,"btn","btn","btn-primary"],[1,"bi","bi-funnel"],[1,"bi","bi-x-circle"],[1,"bodyContent"],[1,"paymentStatusBlock"],[1,"row"],[1,"col-md-3"],[1,"card"],[1,"card-body"],["src","assets/hand-money.gif","alt",""],[1,"ps-text"],[1,"btn","iconBtn"],[1,"bi","bi-eye-slash"],["src","assets/time-money.gif","alt",""],[1,"bi","bi-eye"],[1,"mapBlock"],[1,"col-md-7"],["src","https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d926066.8532744745!2d55.20215!3d24.950846!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1752820983097!5m2!1sen!2sus","allowfullscreen","","loading","lazy","referrerpolicy","no-referrer-when-downgrade",2,"border","0"],[1,"col-md-5"],[1,"cardTitle"],[1,"tableBlock","always-scroll"],[1,"table"],["scope","col"],[1,"tableStatusActive"],["ngbTooltip","Active","placement","top",1,"activeTextStatus"],["ngbTooltip","Inactive","placement","top",1,"inactiveTextStatus"],[1,"overallDataWrapp","mt-3"],[1,"col-md-8"],[1,"paymentStatusBlock","mt-0"],[1,"col-md-4"],[1,"card","mt-0"],[1,"col-md-6"],[1,"col-md-12"],["type","checkbox",3,"checked"]],template:function(s,o){if(1&s){const n=e.RV6();e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"ng-select",4),e.bIt("ngModelChange",function(c){return o.selectedSensorTypes=c}),e.DNE(5,x,2,2,"ng-template",5),e.k0s()(),e.j41(6,"div",3)(7,"ng-select",6),e.bIt("ngModelChange",function(c){return o.selectedCustomers=c}),e.DNE(8,B,2,2,"ng-template",5),e.k0s()(),e.j41(9,"div",3)(10,"ng-select",7),e.bIt("ngModelChange",function(c){return o.selectedDeviceIds=c}),e.DNE(11,V,2,1,"ng-template",8),e.DNE(12,X,2,2,"ng-template",5),e.k0s()(),e.j41(13,"div",9)(14,"input",10,11),e.bIt("ngModelChange",function(c){return o.model=c}),e.k0s(),e.j41(16,"button",12),e.bIt("click",function(){e.eBV(n);const c=e.sdS(15);return e.Njj(c.toggle())}),e.k0s()(),e.j41(17,"div",9)(18,"input",13,11),e.bIt("ngModelChange",function(c){return o.model=c}),e.k0s(),e.j41(20,"button",12),e.bIt("click",function(){e.eBV(n);const c=e.sdS(15);return e.Njj(c.toggle())}),e.k0s()(),e.j41(21,"button",14),e.nrm(22,"i",15),e.EFF(23," Apply"),e.k0s(),e.j41(24,"button",14),e.nrm(25,"i",16),e.EFF(26," Clear"),e.k0s()()()(),e.j41(27,"div",17)(28,"div",18)(29,"h2"),e.EFF(30,"Payment Status"),e.k0s(),e.j41(31,"div",19)(32,"div",20)(33,"div",21)(34,"div",22),e.nrm(35,"img",23),e.j41(36,"div",24)(37,"p"),e.EFF(38,"Fine Received"),e.k0s(),e.j41(39,"h3"),e.EFF(40,"AED 0"),e.k0s()(),e.j41(41,"button",25),e.nrm(42,"i",26),e.k0s()()()(),e.j41(43,"div",20)(44,"div",21)(45,"div",22),e.nrm(46,"img",27),e.j41(47,"div",24)(48,"p"),e.EFF(49,"Fine Pending"),e.k0s(),e.j41(50,"h3"),e.EFF(51,"AED 8050"),e.k0s()(),e.j41(52,"button",25),e.nrm(53,"i",28),e.k0s()()()(),e.j41(54,"div",20)(55,"div",21)(56,"div",22),e.nrm(57,"img",23),e.j41(58,"div",24)(59,"p"),e.EFF(60,"Penalty Received"),e.k0s(),e.j41(61,"h3"),e.EFF(62,"AED 0"),e.k0s()(),e.j41(63,"button",25),e.nrm(64,"i",26),e.k0s()()()(),e.j41(65,"div",20)(66,"div",21)(67,"div",22),e.nrm(68,"img",27),e.j41(69,"div",24)(70,"p"),e.EFF(71,"Penalty Pending"),e.k0s(),e.j41(72,"h3"),e.EFF(73,"AED 4415.5"),e.k0s()(),e.j41(74,"button",25),e.nrm(75,"i",28),e.k0s()()()()()(),e.j41(76,"div",29)(77,"div",19)(78,"div",30)(79,"div",21)(80,"div",22),e.nrm(81,"iframe",31),e.k0s()()(),e.j41(82,"div",32)(83,"div",21)(84,"div",22)(85,"div",33)(86,"h2"),e.EFF(87,"Customer Liabilities"),e.k0s()(),e.j41(88,"div",34)(89,"table",35)(90,"thead")(91,"tr")(92,"th",36),e.EFF(93,"Customer Name"),e.k0s(),e.j41(94,"th"),e.EFF(95,"Fine"),e.k0s(),e.j41(96,"th"),e.EFF(97,"Penalty"),e.k0s(),e.j41(98,"th"),e.EFF(99,"Device Status"),e.k0s()()(),e.j41(100,"tbody")(101,"tr")(102,"td"),e.EFF(103,"Majid"),e.k0s(),e.j41(104,"td"),e.EFF(105,"1800"),e.k0s(),e.j41(106,"td"),e.EFF(107,"910"),e.k0s(),e.j41(108,"td")(109,"div",37)(110,"h4",38),e.EFF(111,"3"),e.k0s(),e.j41(112,"h4",39),e.EFF(113,"0"),e.k0s()()()(),e.j41(114,"tr")(115,"td"),e.EFF(116,"Majid"),e.k0s(),e.j41(117,"td"),e.EFF(118,"1800"),e.k0s(),e.j41(119,"td"),e.EFF(120,"910"),e.k0s(),e.j41(121,"td")(122,"div",37)(123,"h4",38),e.EFF(124,"3"),e.k0s(),e.j41(125,"h4",39),e.EFF(126,"0"),e.k0s()()()(),e.j41(127,"tr")(128,"td"),e.EFF(129,"Majid"),e.k0s(),e.j41(130,"td"),e.EFF(131,"1800"),e.k0s(),e.j41(132,"td"),e.EFF(133,"910"),e.k0s(),e.j41(134,"td")(135,"div",37)(136,"h4",38),e.EFF(137,"3"),e.k0s(),e.j41(138,"h4",39),e.EFF(139,"0"),e.k0s()()()(),e.j41(140,"tr")(141,"td"),e.EFF(142,"Majid"),e.k0s(),e.j41(143,"td"),e.EFF(144,"1800"),e.k0s(),e.j41(145,"td"),e.EFF(146,"910"),e.k0s(),e.j41(147,"td")(148,"div",37)(149,"h4",38),e.EFF(150,"3"),e.k0s(),e.j41(151,"h4",39),e.EFF(152,"0"),e.k0s()()()()()()()()()()()(),e.j41(153,"div",40)(154,"div",19)(155,"div",41)(156,"div",21)(157,"div",22)(158,"div",33)(159,"h2"),e.EFF(160,"Overall Data"),e.k0s()(),e.j41(161,"div",42)(162,"div",19)(163,"div",43)(164,"div",44)(165,"div",22),e.nrm(166,"img",27),e.j41(167,"div",24)(168,"p"),e.EFF(169,"Sensor Groups"),e.k0s(),e.j41(170,"h3"),e.EFF(171,"4"),e.k0s()(),e.j41(172,"button",25),e.nrm(173,"i",28),e.k0s()()()(),e.j41(174,"div",43)(175,"div",44)(176,"div",22),e.nrm(177,"img",23),e.j41(178,"div",24)(179,"p"),e.EFF(180,"Total Warnings"),e.k0s(),e.j41(181,"h3"),e.EFF(182,"42"),e.k0s()(),e.j41(183,"button",25),e.nrm(184,"i",28),e.k0s()()()(),e.j41(185,"div",43)(186,"div",44)(187,"div",22),e.nrm(188,"img",27),e.j41(189,"div",24)(190,"p"),e.EFF(191,"Total Violations"),e.k0s(),e.j41(192,"h3"),e.EFF(193,"12"),e.k0s()(),e.j41(194,"button",25),e.nrm(195,"i",28),e.k0s()()()()()()()()(),e.j41(196,"div",43)(197,"div",21)(198,"div",22)(199,"div",33)(200,"h2"),e.EFF(201,"Device Status"),e.k0s(),e.j41(202,"button",25),e.nrm(203,"i",28),e.k0s()()()()()()(),e.j41(204,"div",40)(205,"div",19)(206,"div",45)(207,"div",21)(208,"div",22)(209,"div",33)(210,"h2"),e.EFF(211,"Sensor Parameter Breached"),e.k0s()()()()(),e.j41(212,"div",45)(213,"div",21)(214,"div",22)(215,"div",33)(216,"h2"),e.EFF(217,"Violations"),e.k0s()()()()()()(),e.j41(218,"div",40)(219,"div",19)(220,"div",46)(221,"div",21)(222,"div",22)(223,"div",33)(224,"h2"),e.EFF(225,"Parameter Reading"),e.k0s()()()()()()()()}2&s&&(e.R7$(4),e.Y8G("items",o.sensorTypes)("multiple",!0)("closeOnSelect",!1)("searchable",!1)("ngModel",o.selectedSensorTypes),e.R7$(3),e.Y8G("items",o.customers)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("ngModel",o.selectedCustomers),e.R7$(3),e.Y8G("items",o.groupedDeviceIds)("multiple",!0)("closeOnSelect",!1)("searchable",!0)("ngModel",o.selectedDeviceIds),e.R7$(4),e.Y8G("ngModel",o.model),e.R7$(4),e.Y8G("ngModel",o.model))},dependencies:[d.cw,d.md,r.me,r.BC,h.ZP,g.vr,g.bh,g.Uq,r.vS]})}}return i})();var T=p(3418);function J(i,l){if(1&i&&(e.j41(0,"option",29),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.JRh(t.customer_type)}}function Z(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select customer type "),e.k0s())}function W(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter contact person name "),e.k0s())}function Q(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter valid customer name (only lowercase without space) "),e.k0s())}function K(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter organization name "),e.k0s())}function ee(i,l){1&i&&(e.j41(0,"div")(1,"small",9),e.EFF(2,"Enter contact number"),e.k0s()())}function te(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter email "),e.k0s())}function oe(i,l){1&i&&e.EFF(0),2&i&&e.SpI(" ",l.item.code," ")}function se(i,l){if(1&i&&(e.nrm(0,"span"),e.EFF(1)),2&i){const t=l.item;e.ZvI("fi fi-",t.country_code.toLowerCase()," mr-2"),e.R7$(1),e.Lme(" ",t.country," (",t.code,") ")}}function ie(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select currency "),e.k0s())}const v=function(i){return{"is-invalid":i}};function ne(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",8)(1,"label"),e.EFF(2,"Currency "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ng-select",31),e.bIt("ngModelChange",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.selectedCurrency=o)}),e.DNE(6,oe,1,1,"ng-template",32),e.DNE(7,se,2,5,"ng-template",33),e.k0s(),e.DNE(8,ie,2,0,"div",13),e.k0s()}if(2&i){const t=e.XpG();e.R7$(5),e.Y8G("items",t.currencyList)("ngModel",t.selectedCurrency)("searchable",!0)("clearable",!0)("ngClass",e.eq3(6,v,t.isFieldInvalid("currency"))),e.R7$(3),e.Y8G("ngIf",t.isFieldInvalid("currency"))}}function re(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter password "),e.k0s())}function ae(i,l){if(1&i&&(e.j41(0,"div",8)(1,"label"),e.EFF(2,"Password "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.nrm(5,"input",34),e.DNE(6,re,2,0,"div",13),e.k0s()),2&i){const t=e.XpG();e.R7$(5),e.Y8G("ngClass",e.eq3(2,v,t.isFieldInvalid("password"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("password"))}}function le(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter trade licence "),e.k0s())}function ce(i,l){if(1&i&&(e.j41(0,"div",8)(1,"label"),e.EFF(2,"Trade License ID "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.nrm(5,"input",35),e.DNE(6,le,2,0,"div",13),e.k0s()),2&i){const t=e.XpG();e.R7$(5),e.Y8G("ngClass",e.eq3(2,v,t.isFieldInvalid("tradeLicenseId"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("tradeLicenseId"))}}function de(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter VAT (Value - Added Tax) "),e.k0s())}function me(i,l){if(1&i&&(e.j41(0,"div",8)(1,"label"),e.EFF(2,"VAT ID "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.nrm(5,"input",36),e.DNE(6,de,2,0,"div",13),e.k0s()),2&i){const t=e.XpG();e.R7$(5),e.Y8G("ngClass",e.eq3(2,v,t.isFieldInvalid("vatId"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("vatId"))}}function ue(i,l){if(1&i&&(e.j41(0,"option",29),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI("",t.plan_name," ")}}function pe(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select plan details "),e.k0s())}function he(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Enter plot no, street name "),e.k0s())}function ge(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select country "),e.k0s())}function fe(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select state "),e.k0s())}function ve(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",8)(1,"label"),e.EFF(2,"State "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ng-select",37),e.bIt("ngModelChange",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.selectedState=o)})("change",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.getCities())}),e.k0s(),e.DNE(6,fe,2,0,"div",13),e.k0s()}if(2&i){const t=e.XpG();e.R7$(5),e.Y8G("items",t.states)("ngModel",t.selectedState)("searchable",!0)("clearable",!0)("ngClass",e.eq3(6,v,t.isFieldInvalid("state"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("state"))}}function _e(i,l){1&i&&(e.j41(0,"div",30),e.EFF(1," Select city "),e.k0s())}function be(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",8)(1,"label"),e.EFF(2,"City "),e.j41(3,"span",9),e.EFF(4,"*"),e.k0s()(),e.j41(5,"ng-select",38),e.bIt("ngModelChange",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.selectedCity=o)}),e.k0s(),e.DNE(6,_e,2,0,"div",13),e.k0s()}if(2&i){const t=e.XpG();e.R7$(5),e.Y8G("items",t.cities)("ngModel",t.selectedCity)("searchable",!0)("clearable",!0)("ngClass",e.eq3(6,v,t.isFieldInvalid("city"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("city"))}}function Fe(i,l){if(1&i&&(e.j41(0,"li",48),e.nrm(1,"i",49),e.j41(2,"span",50),e.EFF(3),e.k0s()()),2&i){const t=l.$implicit;e.R7$(3),e.JRh(t)}}function Ce(i,l){if(1&i&&(e.j41(0,"div",39)(1,"div",40)(2,"h5",41),e.EFF(3),e.k0s(),e.nrm(4,"hr",42),e.j41(5,"p",43),e.EFF(6),e.j41(7,"span",44),e.EFF(8),e.k0s()(),e.j41(9,"p",45),e.EFF(10,"This plan includes:"),e.k0s(),e.j41(11,"ul",46),e.DNE(12,Fe,4,1,"li",47),e.k0s()()()),2&i){const t=e.XpG();e.R7$(3),e.SpI("",t.selectedPlan.plan_name," Plan"),e.R7$(3),e.SpI(" AED ",t.selectedPlan.price," "),e.R7$(2),e.SpI("/ ",t.selectedPlan.period,""),e.R7$(4),e.Y8G("ngForOf",t.selectedPlan.descriptions)}}const ye=function(i,l){return[i,l]};let w=(()=>{class i{constructor(t,s,o,n,a){this.activeModal=t,this.fb=s,this.customerAdminService=o,this.appStateService=n,this.toastService=a,this.mode="create",this.formSubmitted=!1,this.SearchCountryField="all",this.CountryISO=h.ij,this.preferredCountries=[h.ij.India,h.ij.UnitedStates],this.selectedCountryISO="IN",this.currencyList=[],this.customerTypes=[],this.units=[],this.countries=[],this.states=[],this.cities=[],this.planDetails=[],this.userId=0,this.organizationId=0,this.selectedPlan=null,this.isPlanSelected=!1}ngOnInit(){this.customerForm=this.fb.group({customerType:["",r.k0.required],contactPersonName:["",r.k0.required],customerName:["",r.k0.required],organizationName:["",r.k0.required],contactNumber:["",r.k0.required],email:["",[r.k0.required,r.k0.email]],currency:["",r.k0.required],password:["","create"===this.mode?[r.k0.required,r.k0.minLength(8)]:[]],planDetails:["",r.k0.required],address:["",r.k0.required],country:["",r.k0.required],state:["",r.k0.required],city:["",r.k0.required],tradeLicenseId:["","edit"===this.mode?[r.k0.required]:[]],vatId:["","edit"===this.mode?[r.k0.required]:[]]}),this.userId=this.appStateService.getUser().user.id,this.organizationId=this.appStateService.getUser().user.organization_id,this.data&&(this.selectedCurrency=this.data.currency),this.getCurrencies(),this.getCustomerTypes(),this.getCountries(),this.getSubscriptionPlans(),"edit"===this.mode&&(console.log(this.data),this.selectedCountry=this.data.country_id,this.getStates(),this.selectedState=this.data.state_id,this.getCities(),this.selectedCity=this.data.city_id,this.selectedCountryISO=JSON.parse(this.data.contact_object).countryCode,this.customerForm.patchValue({customerType:this.data.customer_type,contactPersonName:this.data.contact_person_name,customerName:this.data.customer_name,organizationName:this.data.organization_name,contactNumber:this.data.contact_number,email:this.data.email,currency:this.data.currency,planDetails:this.data.plan_id,address:this.data.address,country:this.data.country_id,state:this.data.state_id,city:this.data.city_id,tradeLicenseId:this.data.trade_license_id,vatId:this.data.vat_id}))}isFieldInvalid(t){const s=this.customerForm.get(t);return!(!s||!s.touched&&!this.formSubmitted||!s.invalid)}getCurrencies(){this.customerAdminService.getCurrencies().subscribe(t=>{this.currencyList=t.data})}getCustomerTypes(){this.customerAdminService.getCustomerTypes().subscribe(t=>{this.customerTypes=t.data})}getCountries(){this.customerAdminService.getCountries().subscribe(t=>{this.countries=t.data})}getStates(){this.selectedState=null,this.customerAdminService.getStates(this.selectedCountry).subscribe(t=>{this.states=t.data})}getCities(){this.selectedCity=null,this.customerAdminService.getCities(this.selectedState).subscribe(t=>{this.cities=t.data})}getSubscriptionPlans(){this.customerAdminService.getSubscriptions({customer_id:this.userId,organization:this.organizationId}).subscribe(s=>{this.planDetails=s.data})}onSubmit(){if(this.formSubmitted=!0,this.customerForm.valid)if("create"===this.mode){const t=T.Y8(this.customerForm.value.password,10),s={customer_type:this.customerForm.value.customerType,customer_name:this.customerForm.value.customerName,username:this.customerForm.value.customerName,email:this.customerForm.value.email,organization_name:this.customerForm.value.organizationName,contact_person_name:this.customerForm.value.contactPersonName,contact_number:this.customerForm.value.contactNumber.internationalNumber,contact_object:JSON.stringify(this.customerForm.value.contactNumber),currency:this.customerForm.value.currency,password:t,plan_id:this.customerForm.value.planDetails,address:this.customerForm.value.address,country_id:this.customerForm.value.country,state_id:this.customerForm.value.state,city_id:this.customerForm.value.city,created_by:this.userId,roleid:3,organization:this.organizationId};this.customerAdminService.createCustomer(s).subscribe(o=>{o.success?(this.toastService.showSuccess("Customer admin created successfully"),this.activeModal.close("saved"),this.customerForm.reset()):this.toastService.showError("Failed to create customer admin")},o=>{this.toastService.showError(o.error.message)}),this.formSubmitted=!1}else if("edit"===this.mode){const t={customer_id:this.data.id,username:this.customerForm.value.customerName,organization_name:this.customerForm.value.organizationName,contact_person_name:this.customerForm.value.contactPersonName,customer_name:this.customerForm.value.customerName,customer_type:this.customerForm.value.customerType,email:this.customerForm.value.email,contact_number:this.customerForm.value.contactNumber.internationalNumber,contact_object:JSON.stringify(this.customerForm.value.contactNumber),currency:this.customerForm.value.currency,trade_license_id:this.customerForm.value.tradeLicenseId,vat_id:this.customerForm.value.vatId,plan_id:this.customerForm.value.planDetails,address:this.customerForm.value.address,country_id:this.customerForm.value.country,roleid:2,state_id:this.customerForm.value.state,city_id:this.customerForm.value.city,modified_by:this.userId,organization:this.organizationId};this.customerAdminService.updateCustomer(this.data.id,t).subscribe(s=>{s.success?(this.toastService.showSuccess("Customer admin updated successfully"),this.activeModal.close("saved"),this.customerForm.reset()):this.toastService.showError("Failed to update customer admin")},s=>{this.toastService.showError(s.error.message)}),this.formSubmitted=!1}}close(){this.activeModal.dismiss()}removeInvalidChars(t){const s=t.target;s.value=s.value.replace(/[^a-zA-Z0-9]/g,""),this.customerForm.get("customerName")?.setValue(s.value)}onPlanChange(t){const s=t.target.value;this.selectedPlan=this.planDetails.find(n=>n.id==s),this.isPlanSelected=!0,console.log("selectedPlan",this.selectedPlan);const o=document.querySelector(".modal.show .modal-dialog");o&&(o.classList.remove("modal-lg","modal-xl"),o.classList.add(this.selectedPlan?.id?"custom-modal-xl":"modal-lg"))}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Lw),e.rXU(r.ok),e.rXU(_),e.rXU(b.i),e.rXU(F.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-customer-admin-form"]],inputs:{mode:"mode",data:"data"},decls:91,vars:65,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["novalidate","",3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[3,"ngClass"],[1,"col-md-6","mb-1"],[1,"text-danger"],["formControlName","customerType",1,"form-control",3,"ngClass"],["value","","disabled","",1,"placeholder-option",3,"selected"],[3,"value",4,"ngFor","ngForOf"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","contactPersonName","maxlength","30","placeholder","Enter Contact Person Name",1,"form-control",3,"ngClass"],["type","text","formControlName","customerName","placeholder","Enter Customer Name","maxlength","30","pattern","^[a-zA-Z0-9]{3,30}$",1,"form-control",3,"ngClass","input"],["type","text","formControlName","organizationName","maxlength","30","placeholder","Enter Organization Name",1,"form-control",3,"ngClass"],["name","phone","formControlName","contactNumber",3,"cssClass","preferredCountries","enableAutoCountrySelect","enablePlaceholder","searchCountryFlag","searchCountryField","selectFirstCountry","selectedCountryISO","separateDialCode","maxLength"],[4,"ngIf"],["type","email","formControlName","email","placeholder","Enter Email","maxlength","30",1,"form-control",3,"ngClass"],["class","col-md-6 mb-1",4,"ngIf"],[1,"col-md-12","mb-1"],["formControlName","planDetails",1,"form-control",3,"ngClass","change"],["type","text","formControlName","address","placeholder","Enter Plot No, Street Name",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Select Country","formControlName","country",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange","change"],["class","col-md-4",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"],[1,"invalid-feedback"],["bindLabel","country","bindValue","code","placeholder","Select Currency","formControlName","currency",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange"],["ng-label-tmp",""],["ng-option-tmp",""],["type","password","formControlName","password","placeholder","Enter Password","maxlength","30",1,"form-control",3,"ngClass"],["type","text","formControlName","tradeLicenseId","placeholder","Trade License ID","maxlength","30",1,"form-control",3,"ngClass"],["type","text","formControlName","vatId","placeholder","VAT ID","maxlength","30",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Select State","formControlName","state",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange","change"],["bindLabel","name","bindValue","id","placeholder","Select City","formControlName","city",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange"],[1,"col-md-4"],[1,"plan-preview-card","p-3","border","rounded","shadow-sm"],[1,"fw-bold","text-primary"],[1,"my-2"],[1,"fs-4","fw-bold","text-dark"],[1,"fs-6","text-muted"],[1,"fw-bold","mb-2"],[1,"list-unstyled","mb-0"],["class","mb-1 d-flex align-items-start",4,"ngFor","ngForOf"],[1,"mb-1","d-flex","align-items-start"],[1,"bi","bi-check-circle-fill","text-success","me-2","mt-1"],[1,"small"]],template:function(s,o){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.close()}),e.k0s()(),e.j41(5,"form",4),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",5)(7,"div",6)(8,"div",7)(9,"div",6)(10,"div",8)(11,"label"),e.EFF(12,"Customer Type "),e.j41(13,"span",9),e.EFF(14,"*"),e.k0s()(),e.j41(15,"select",10)(16,"option",11),e.EFF(17,"Select Customer Type"),e.k0s(),e.DNE(18,J,2,2,"option",12),e.k0s(),e.DNE(19,Z,2,0,"div",13),e.k0s(),e.j41(20,"div",8)(21,"label"),e.EFF(22,"Contact Person Name "),e.j41(23,"span",9),e.EFF(24,"*"),e.k0s()(),e.nrm(25,"input",14),e.DNE(26,W,2,0,"div",13),e.k0s(),e.j41(27,"div",8)(28,"label"),e.EFF(29,"Customer Name "),e.j41(30,"span",9),e.EFF(31,"*"),e.k0s()(),e.j41(32,"input",15),e.bIt("input",function(a){return o.removeInvalidChars(a)}),e.k0s(),e.DNE(33,Q,2,0,"div",13),e.k0s(),e.j41(34,"div",8)(35,"label"),e.EFF(36,"Organization Name "),e.j41(37,"span",9),e.EFF(38,"*"),e.k0s()(),e.nrm(39,"input",16),e.DNE(40,K,2,0,"div",13),e.k0s(),e.j41(41,"div",8)(42,"label"),e.EFF(43,"Contact Number "),e.j41(44,"span",9),e.EFF(45,"*"),e.k0s()(),e.nrm(46,"ngx-intl-tel-input",17),e.DNE(47,ee,3,0,"div",18),e.k0s(),e.j41(48,"div",8)(49,"label"),e.EFF(50,"Email "),e.j41(51,"span",9),e.EFF(52,"*"),e.k0s()(),e.nrm(53,"input",19),e.DNE(54,te,2,0,"div",13),e.k0s(),e.DNE(55,ne,9,8,"div",20),e.DNE(56,ae,7,4,"div",20),e.DNE(57,ce,7,4,"div",20),e.DNE(58,me,7,4,"div",20),e.j41(59,"div",21)(60,"label"),e.EFF(61,"Plan Details "),e.j41(62,"span",9),e.EFF(63,"*"),e.k0s()(),e.j41(64,"select",22),e.bIt("change",function(a){return o.onPlanChange(a)}),e.j41(65,"option",11),e.EFF(66,"Select Plan Details"),e.k0s(),e.DNE(67,ue,2,2,"option",12),e.k0s(),e.DNE(68,pe,2,0,"div",13),e.k0s(),e.j41(69,"div",8)(70,"label"),e.EFF(71,"Plot No, Street Name "),e.j41(72,"span",9),e.EFF(73,"*"),e.k0s()(),e.nrm(74,"input",23),e.DNE(75,he,2,0,"div",13),e.k0s(),e.j41(76,"div",8)(77,"label"),e.EFF(78,"Country "),e.j41(79,"span",9),e.EFF(80,"*"),e.k0s()(),e.j41(81,"ng-select",24),e.bIt("ngModelChange",function(a){return o.selectedCountry=a})("change",function(){return o.getStates()}),e.k0s(),e.DNE(82,ge,2,0,"div",13),e.k0s(),e.DNE(83,ve,7,8,"div",20),e.DNE(84,be,7,8,"div",20),e.k0s()(),e.DNE(85,Ce,13,4,"div",25),e.k0s()(),e.j41(86,"div",26)(87,"button",27),e.bIt("click",function(){return o.close()}),e.EFF(88,"Cancel"),e.k0s(),e.j41(89,"button",28),e.EFF(90,"Save"),e.k0s()()()()),2&s){let n,a,c;e.R7$(3),e.SpI(" ","edit"===o.mode?"Edit Customer Admin":"Add Customer Admin"," "),e.R7$(2),e.Y8G("formGroup",o.customerForm),e.R7$(3),e.Y8G("ngClass",o.isPlanSelected?"col-md-8":"col-md-12"),e.R7$(7),e.Y8G("ngClass",e.eq3(46,v,o.isFieldInvalid("customerType"))),e.R7$(1),e.Y8G("selected",!(null!=(n=o.customerForm.get("customerType"))&&n.value)),e.R7$(2),e.Y8G("ngForOf",o.customerTypes),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("customerType")),e.R7$(6),e.Y8G("ngClass",e.eq3(48,v,o.isFieldInvalid("contactPersonName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("contactPersonName")),e.R7$(6),e.Y8G("ngClass",e.eq3(50,v,o.isFieldInvalid("customerName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("customerName")),e.R7$(6),e.Y8G("ngClass",e.eq3(52,v,o.isFieldInvalid("organizationName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("organizationName")),e.R7$(6),e.Y8G("cssClass","form-control")("preferredCountries",o.preferredCountries)("enableAutoCountrySelect",!1)("enablePlaceholder",!0)("searchCountryFlag",!1)("searchCountryField",e.l_i(54,ye,o.SearchCountryField.Name,o.SearchCountryField.DialCode))("selectFirstCountry",!1)("selectedCountryISO",o.selectedCountryISO)("separateDialCode",!0)("maxLength",15),e.R7$(1),e.Y8G("ngIf",(null==(a=o.customerForm.get("contactNumber"))?null:a.invalid)&&((null==(a=o.customerForm.get("contactNumber"))?null:a.touched)||o.formSubmitted)),e.R7$(6),e.Y8G("ngClass",e.eq3(57,v,o.isFieldInvalid("email"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("email")),e.R7$(1),e.Y8G("ngIf","create"===o.mode),e.R7$(1),e.Y8G("ngIf","create"===o.mode),e.R7$(1),e.Y8G("ngIf","edit"===o.mode),e.R7$(1),e.Y8G("ngIf","edit"===o.mode),e.R7$(6),e.Y8G("ngClass",e.eq3(59,v,o.isFieldInvalid("planDetails"))),e.R7$(1),e.Y8G("selected",!(null!=(c=o.customerForm.get("planDetails"))&&c.value)),e.R7$(2),e.Y8G("ngForOf",o.planDetails),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("planDetails")),e.R7$(6),e.Y8G("ngClass",e.eq3(61,v,o.isFieldInvalid("address"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("address")),e.R7$(6),e.Y8G("items",o.countries)("ngModel",o.selectedCountry)("searchable",!0)("clearable",!0)("ngClass",e.eq3(63,v,o.isFieldInvalid("country"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("country")),e.R7$(1),e.Y8G("ngIf",o.selectedCountry),e.R7$(1),e.Y8G("ngIf",o.selectedState),e.R7$(1),e.Y8G("ngIf",o.isPlanSelected),e.R7$(4),e.Y8G("disabled",o.customerForm.invalid)}},dependencies:[m.YU,m.Sq,m.bT,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.tU,r.R_,r.j4,r.JD,h.NA,h.ZP,g.vr,g.Uq,g.ZZ]})}}return i})();var ke=p(8032),C=p.n(ke);const Se=["mapContainer"],Ee=["searchInput"];let Pe=(()=>{class i{constructor(t,s){this.activeModal=t,this.ngZone=s,this.markerPosition={lat:25.276987,lng:55.296249},this.zoom=12,this.observer=null,this.inputListeners=[],this.autocompleteListeners=[]}ngOnInit(){console.log("LocationPickerComponent initialized"),console.log("Window google object:",window.google),console.log("Google maps available:",!!window.google?.maps),console.log("Google places available:",!!window.google?.maps?.places);const t=document.querySelectorAll('script[src*="maps.googleapis.com"]');console.log("Google Maps script tags found:",t.length),t.forEach((s,o)=>{const n=s.src;console.log(`Script ${o}:`,n);const a=n.match(/key=([^&]+)/);a&&(console.log("API Key found:",a[1]),console.log("API Key length:",a[1].length))}),this.cleanup(),this.setupDropdownWatcher(),this.waitForGoogle().then(()=>{console.log("Google Maps API loaded successfully"),this.initMap()}).catch(s=>{console.error("Failed to load Google Maps API:",s),this.showErrorMessage("Failed to load Google Maps API. Please check your API key and internet connection.")})}ngOnDestroy(){this.cleanup()}setupDropdownWatcher(){this.observer&&this.observer.disconnect(),this.observer=new MutationObserver(t=>{t.forEach(s=>{"childList"===s.type&&s.addedNodes.forEach(o=>{o.nodeType===Node.ELEMENT_NODE&&o.classList&&o.classList.contains("pac-container")&&(console.log("\u{1f3af} PAC container detected! Making it visible..."),setTimeout(()=>this.ensureDropdownVisible(),50))})})}),this.observer.observe(document.body,{childList:!0,subtree:!0}),console.log("\u2705 MutationObserver set up to watch for PAC container")}waitForGoogle(){return new Promise((t,s)=>{let o=0;const a=()=>{if(o++,console.log(`Checking Google Maps API... Attempt ${o}`),window.google&&window.google.maps&&window.google.maps.places)console.log("Google Maps API is available"),t();else if(o>=50){const c=new Error("Google Maps API failed to load after 5 seconds. Please check your API key and ensure the Places API is enabled.");console.error(c.message),s(c)}else setTimeout(a,100)};a()})}showErrorMessage(t){console.error(t),alert(t)}initMap(){try{console.log("Initializing map..."),this.map=new google.maps.Map(this.mapContainer.nativeElement,{center:this.markerPosition,zoom:this.zoom,mapTypeId:google.maps.MapTypeId.ROADMAP}),console.log("Map created successfully"),this.marker=new google.maps.Marker({position:this.markerPosition,map:this.map,draggable:!0}),console.log("Marker created successfully"),this.map.addListener("click",t=>{console.log("Map clicked at:",t.latLng),this.updateMarkerPosition(t.latLng),this.reverseGeocode(t.latLng)}),this.initAutocomplete(),this.marker.addListener("dragend",()=>{const t=this.marker.getPosition();t&&(this.markerPosition={lat:t.lat(),lng:t.lng()},console.log("Marker dragged to:",this.markerPosition),this.reverseGeocode(t))})}catch(t){console.error("Error initializing map:",t)}}updateMarkerPosition(t){this.marker.setPosition(t),this.markerPosition={lat:t.lat(),lng:t.lng()},console.log("Marker position updated to:",this.markerPosition)}reverseGeocode(t){console.log("Reverse geocoding coordinates:",t.lat(),t.lng()),(new google.maps.Geocoder).geocode({location:t},(o,n)=>{if(n===google.maps.GeocoderStatus.OK&&o.length>0){const c=o[0].formatted_address;console.log("Reverse geocoded address:",c),this.ngZone.run(()=>{this.searchInput.nativeElement.value=c,console.log("Search input updated with address:",c)})}else{console.warn("Reverse geocoding failed:",n);const a=`${t.lat().toFixed(6)}, ${t.lng().toFixed(6)}`;this.ngZone.run(()=>{this.searchInput.nativeElement.value=a,console.log("Search input updated with coordinates:",a)})}})}initAutocomplete(){try{console.log("Initializing Places Autocomplete..."),console.log("Search input element:",this.searchInput.nativeElement),console.log("Search input value:",this.searchInput.nativeElement.value),this.autocomplete&&(google.maps.event.clearInstanceListeners(this.autocomplete),this.autocomplete=null),this.autocomplete=new google.maps.places.Autocomplete(this.searchInput.nativeElement,{types:["geocode","establishment"],componentRestrictions:{country:"AE"}}),console.log("Autocomplete object created:",this.autocomplete),setTimeout(()=>{console.log("Testing autocomplete dropdown visibility..."),this.searchInput.nativeElement.focus(),this.searchInput.nativeElement.value="Dubai",this.searchInput.nativeElement.dispatchEvent(new Event("input")),setTimeout(()=>{const a=document.querySelector(".pac-container");console.log("PAC container found:",a),a&&(console.log("PAC container styles:",window.getComputedStyle(a)),console.log("PAC container z-index:",window.getComputedStyle(a).zIndex))},1e3)},500);const t=this.autocomplete.addListener("bounds_changed",()=>{console.log("Bounds changed, ensuring dropdown visibility"),this.ensureDropdownVisible()});this.autocompleteListeners.push(()=>google.maps.event.removeListener(t));const s=this.autocomplete.addListener("place_changed",()=>{console.log("Place selected from autocomplete"),this.ngZone.run(()=>{const a=this.autocomplete.getPlace();if(console.log("Selected place:",a),!a.geometry||!a.geometry.location)return void console.warn("Place has no geometry");const c=a.geometry.location;console.log("Place location:",{lat:c.lat(),lng:c.lng()}),this.map.setCenter(c),this.map.setZoom(16),this.marker.setPosition(c),this.markerPosition={lat:c.lat(),lng:c.lng()},console.log("Updated marker position:",this.markerPosition)})});this.autocompleteListeners.push(()=>google.maps.event.removeListener(s));const o=()=>{console.log("Input event triggered, ensuring dropdown visibility"),setTimeout(()=>this.ensureDropdownVisible(),100)};this.searchInput.nativeElement.addEventListener("input",o),this.inputListeners.push(()=>this.searchInput.nativeElement.removeEventListener("input",o));const n=()=>{console.log("Input focused, ensuring dropdown visibility"),setTimeout(()=>this.ensureDropdownVisible(),100)};this.searchInput.nativeElement.addEventListener("focus",n),this.inputListeners.push(()=>this.searchInput.nativeElement.removeEventListener("focus",n)),console.log("Places Autocomplete initialized successfully")}catch(t){console.error("Error initializing Places Autocomplete:",t);const s=t instanceof Error?t.message:"Unknown error";this.showErrorMessage(`Failed to initialize Places Autocomplete: ${s}`)}}ensureDropdownVisible(){const t=document.querySelector(".pac-container");t?(console.log("\u{1f3af} Making PAC container visible..."),t.style.setProperty("display","block","important"),t.removeAttribute("aria-hidden"),t.style.setProperty("z-index","9999","important"),t.style.setProperty("position","fixed","important"),t.style.setProperty("visibility","visible","important"),t.style.setProperty("opacity","1","important"),t.style.removeProperty("display"),t.style.removeProperty("visibility"),t.style.removeProperty("opacity"),t.style.setProperty("display","block","important"),console.log("\u2705 Forced dropdown to be visible"),setTimeout(()=>{const s=window.getComputedStyle(t);console.log("Final dropdown styles:",{display:s.display,visibility:s.visibility,zIndex:s.zIndex,position:s.position})},100)):console.log("No PAC container found to make visible")}confirmLocation(){console.log("Confirming location:",this.markerPosition),this.activeModal.close(this.markerPosition)}testPlacesAPI(){if(console.log("Testing Places API..."),console.log("Google object available:",!!window.google),console.log("Google maps available:",!!window.google?.maps),console.log("Google places available:",!!window.google?.maps?.places),this.autocomplete){console.log("Autocomplete object:",this.autocomplete),console.log("Search input element:",this.searchInput.nativeElement);try{const t=new google.maps.places.AutocompleteService;console.log("AutocompleteService created:",t),t.getPlacePredictions({input:"Dubai",types:["geocode"]},(s,o)=>{console.log("Predictions status:",o),console.log("Predictions:",s),o===google.maps.places.PlacesServiceStatus.OK?console.log("Places API is working correctly!"):(console.error("Places API error status:",o),this.showErrorMessage(`Places API error: ${o}`))})}catch(t){console.error("Error testing Places API:",t);const s=t instanceof Error?t.message:"Unknown error";this.showErrorMessage(`Error testing Places API: ${s}`)}}else console.error("Autocomplete not initialized"),this.showErrorMessage("Autocomplete not initialized. Please check the console for errors.")}testAPIKey(){console.log("=== API Key Test ===");const t=document.querySelectorAll('script[src*="maps.googleapis.com"]');if(console.log("Google Maps script tags found:",t.length),t.forEach((s,o)=>{const n=s.src;console.log(`Script ${o}:`,n);const a=n.match(/key=([^&]+)/);a&&(console.log("API Key found:",a[1]),console.log("API Key length:",a[1].length))}),console.log("Window google object:",window.google),console.log("Google maps available:",!!window.google?.maps),console.log("Google places available:",!!window.google?.maps?.places),window.google?.maps)try{new google.maps.Map(document.createElement("div"),{center:{lat:0,lng:0},zoom:1}),console.log("\u2705 Basic map creation works")}catch(s){console.error("\u274c Basic map creation failed:",s)}if(window.google?.maps?.places)try{const s=new google.maps.places.AutocompleteService;console.log("\u2705 Places AutocompleteService creation works"),s.getPlacePredictions({input:"Test",types:["geocode"]},(o,n)=>{console.log("Places API test result - Status:",n),console.log("Places API test result - Predictions count:",o?.length||0),n===google.maps.places.PlacesServiceStatus.OK?console.log("\u2705 Places API is working correctly!"):n===google.maps.places.PlacesServiceStatus.REQUEST_DENIED?(console.error("\u274c Places API request denied - Check API key and billing"),this.showErrorMessage("Places API request denied. Please check your API key and ensure billing is enabled.")):n===google.maps.places.PlacesServiceStatus.OVER_QUERY_LIMIT?(console.error("\u274c Places API quota exceeded"),this.showErrorMessage("Places API quota exceeded. Please check your billing and usage limits.")):n===google.maps.places.PlacesServiceStatus.INVALID_REQUEST?(console.error("\u274c Places API invalid request"),this.showErrorMessage("Places API invalid request. Please check your request parameters.")):(console.error("\u274c Places API error:",n),this.showErrorMessage(`Places API error: ${n}`))})}catch(s){console.error("\u274c Places API test failed:",s);const o=s instanceof Error?s.message:"Unknown error";this.showErrorMessage(`Places API test failed: ${o}`)}else console.error("\u274c Places API not available"),this.showErrorMessage("Places API not available. Please check if the Google Maps script loaded correctly.")}testAutocompleteDropdown(){console.log("=== Testing Autocomplete Dropdown ==="),this.autocomplete?(console.log("\u2705 Autocomplete is initialized"),this.searchInput.nativeElement.focus(),this.searchInput.nativeElement.value="Dubai",this.searchInput.nativeElement.dispatchEvent(new Event("input")),console.log('Input focused and value set to "Dubai"'),setTimeout(()=>{const t=document.querySelector(".pac-container");if(console.log("PAC container found:",t),t){const s=window.getComputedStyle(t);console.log("\u2705 PAC container found with styles:",{display:s.display,visibility:s.visibility,zIndex:s.zIndex,position:s.position,top:s.top,left:s.left,width:s.width,height:s.height,backgroundColor:s.backgroundColor});const o=t.querySelectorAll(".pac-item");console.log("PAC items found:",o.length),o.length>0?console.log("\u2705 Autocomplete dropdown is working and visible!"):console.warn("\u26a0\ufe0f PAC container found but no items inside")}else{console.error("\u274c PAC container not found - dropdown may be hidden");const s=document.querySelectorAll('[class*="pac"]');console.log("All PAC-related elements found:",s)}},1e3)):console.error("\u274c Autocomplete not initialized")}reinitializeAutocomplete(){console.log("\u{1f504} Reinitializing autocomplete..."),this.cleanup(),this.setupDropdownWatcher(),this.initAutocomplete(),console.log("\u2705 Autocomplete reinitialized")}getCurrentLocation(){console.log("Getting current location..."),navigator.geolocation?navigator.geolocation.getCurrentPosition(t=>{console.log("Current position obtained:",t);const s=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);this.map.setCenter(s),this.map.setZoom(15),this.updateMarkerPosition(s),this.reverseGeocode(s),console.log("\u2705 Current location set successfully")},t=>{console.error("Error getting current location:",t);let s="Unable to get current location";switch(t.code){case t.PERMISSION_DENIED:s="Location permission denied. Please enable location access.";break;case t.POSITION_UNAVAILABLE:s="Location information unavailable.";break;case t.TIMEOUT:s="Location request timed out."}this.showErrorMessage(s)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4}):(console.error("Geolocation not supported"),this.showErrorMessage("Geolocation is not supported by this browser."))}cleanup(){console.log("\u{1f9f9} Cleaning up component..."),this.observer&&(this.observer.disconnect(),this.observer=null,console.log("\u2705 MutationObserver disconnected")),this.inputListeners.forEach(s=>s()),this.inputListeners=[],console.log("\u2705 Input event listeners removed"),this.autocompleteListeners.forEach(s=>s()),this.autocompleteListeners=[],console.log("\u2705 Autocomplete listeners removed"),this.autocomplete&&(google.maps.event.clearInstanceListeners(this.autocomplete),this.autocomplete=null,console.log("\u2705 Autocomplete instance cleared")),document.querySelectorAll(".pac-container").forEach(s=>s.remove()),console.log("\u2705 Existing PAC containers removed")}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Lw),e.rXU(e.SKi))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-location-picker"]],viewQuery:function(s,o){if(1&s&&(e.GBs(Se,7),e.GBs(Ee,7)),2&s){let n;e.mGM(n=e.lsd())&&(o.mapContainer=n.first),e.mGM(n=e.lsd())&&(o.searchInput=n.first)}},decls:18,vars:0,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title","fw-bold"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","position-relative"],[1,"d-flex","mb-2"],["id","pac-input","type","text","placeholder","Search location",1,"form-control","me-2"],["searchInput",""],[1,"btn","btn-sm","btn-custom-height","btn-primary",3,"click"],[1,"map-instructions"],["id","map",2,"height","400px","width","100%"],["mapContainer",""]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3,"Select sensor location"),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.activeModal.dismiss()}),e.k0s()(),e.j41(5,"div",4)(6,"div",5),e.nrm(7,"input",6,7),e.j41(9,"button",8),e.bIt("click",function(){return o.confirmLocation()}),e.EFF(10,"OK"),e.k0s()(),e.j41(11,"div",9),e.EFF(12," \u{1f4a1} "),e.j41(13,"strong"),e.EFF(14,"Tip:"),e.k0s(),e.EFF(15," Click anywhere on the map to place the marker, or search for a location above "),e.k0s(),e.nrm(16,"div",10,11),e.k0s()())},styles:[".search-box[_ngcontent-%COMP%]{position:absolute;top:10px;left:50%;transform:translate(-50%);z-index:5;width:70%}.control-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-bottom:.25rem}.map-instructions[_ngcontent-%COMP%]{font-size:.875rem;color:#6c757d;margin-bottom:.5rem;text-align:center}[_nghost-%COMP%]     .pac-container{z-index:9999!important;border-radius:4px;box-shadow:0 2px 6px #0000004d;border:1px solid #ccc;font-family:inherit;position:fixed!important;top:auto!important;left:auto!important;width:auto!important;max-width:400px!important;background:white!important;display:block!important}[_nghost-%COMP%]     .pac-item{padding:8px 12px;cursor:pointer;border-bottom:1px solid #f0f0f0;font-size:14px;line-height:1.4}[_nghost-%COMP%]     .pac-item:hover{background-color:#f5f5f5}[_nghost-%COMP%]     .pac-item-selected{background-color:#e3f2fd}[_nghost-%COMP%]     .pac-item-query{font-weight:700;color:#333}[_nghost-%COMP%]     .pac-matched{font-weight:700;color:#1976d2}#pac-input[_ngcontent-%COMP%]{position:relative;z-index:1000;background:white}.modal[_ngcontent-%COMP%]{z-index:1050}.modal-backdrop[_ngcontent-%COMP%]{z-index:1040}.modal-body[_ngcontent-%COMP%]{position:relative;z-index:1051}"]})}}return i})();var A=p(4786);function we(i,l){if(1&i&&(e.j41(0,"div",37),e.nrm(1,"div",38),e.j41(2,"div",38)(3,"label",15),e.EFF(4," Sensor Parameter "),e.j41(5,"span",16),e.EFF(6,"*"),e.k0s()(),e.nrm(7,"input",39),e.k0s(),e.j41(8,"div",38)(9,"label",15),e.EFF(10," Min Threshold Limit "),e.j41(11,"span",16),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",40),e.k0s(),e.j41(14,"div",38)(15,"label",15),e.EFF(16," Max Threshold Limit "),e.j41(17,"span",16),e.EFF(18,"*"),e.k0s()(),e.nrm(19,"input",41),e.k0s()()),2&i){const t=l.index,s=e.XpG(3);e.AVh("has-connector",t<s.sensorParametersArray.length-1),e.Y8G("formGroupName",t)}}function je(i,l){if(1&i&&(e.j41(0,"div",34)(1,"div",35),e.DNE(2,we,20,3,"div",36),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(2),e.Y8G("ngForOf",t.sensorParametersArray.controls)}}const Ie=function(){return[]};function Ne(i,l){if(1&i){const t=e.RV6();e.j41(0,"div")(1,"div",13)(2,"div",14)(3,"label",15),e.EFF(4," Sensor Type "),e.j41(5,"span",16),e.EFF(6,"*"),e.k0s()(),e.j41(7,"ng-select",17),e.bIt("change",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onSensorTypeChange(o))}),e.k0s()(),e.j41(8,"div",14)(9,"label",15),e.EFF(10," Sensor Group Name "),e.j41(11,"span",16),e.EFF(12,"*"),e.k0s()(),e.j41(13,"ng-select",18),e.bIt("change",function(){e.eBV(t);const o=e.XpG();let n;return e.Njj(o.loadSensorParameters(null==(n=o.form.get("step1.sensorType"))?null:n.value,null==(n=o.form.get("step1.sensorGroupName"))?null:n.value))}),e.k0s()(),e.j41(14,"div",19)(15,"label",20),e.EFF(16,"Sensor Parameters"),e.k0s(),e.j41(17,"ui-switch",21),e.bIt("change",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.toggleSensorParams(o))}),e.k0s()()(),e.DNE(18,je,3,1,"div",22),e.j41(19,"div")(20,"div",13)(21,"div",14)(22,"label",15),e.EFF(23,"Customer Name "),e.j41(24,"span",16),e.EFF(25,"*"),e.k0s()(),e.nrm(26,"ng-select",23),e.k0s(),e.j41(27,"div",14)(28,"label",15),e.EFF(29,"Device ID "),e.j41(30,"span",16),e.EFF(31,"*"),e.k0s()(),e.j41(32,"ng-select",24),e.bIt("change",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.onDeviceChange(o))}),e.k0s()(),e.j41(33,"div",14)(34,"label",15),e.EFF(35,"Device Make "),e.j41(36,"span",16),e.EFF(37,"*"),e.k0s()(),e.nrm(38,"input",25),e.k0s(),e.j41(39,"div",14)(40,"label",15),e.EFF(41,"Device Model "),e.j41(42,"span",16),e.EFF(43,"*"),e.k0s()(),e.nrm(44,"input",26),e.k0s()(),e.j41(45,"div",13)(46,"div",13)(47,"div",14)(48,"label",27),e.EFF(49," Device Latitude "),e.j41(50,"span",16),e.EFF(51,"*"),e.k0s()(),e.j41(52,"div",28),e.nrm(53,"input",29),e.j41(54,"button",30),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.openLocationModal("latitude"))}),e.nrm(55,"i",31),e.k0s()()(),e.j41(56,"div",14)(57,"label",32),e.EFF(58," Device Longitude "),e.j41(59,"span",16),e.EFF(60,"*"),e.k0s()(),e.j41(61,"div",28),e.nrm(62,"input",33),e.j41(63,"button",30),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.openLocationModal("longitude"))}),e.nrm(64,"i",31),e.k0s()()()()()()()}if(2&i){const t=e.XpG();let s;e.R7$(7),e.Y8G("items",t.sensorTypes)("clearable",!1),e.R7$(6),e.Y8G("items",t.sensorGroupNameOptions[null==(s=t.form.get("step1.sensorType"))?null:s.value]||e.lJ4(10,Ie))("clearable",!1),e.R7$(4),e.Y8G("checked",t.sensorParamsEnabled),e.R7$(1),e.Y8G("ngIf",t.showSensorParams),e.R7$(8),e.Y8G("items",t.customers)("clearable",!1),e.R7$(6),e.Y8G("items",t.devices)("clearable",!1)}}function Ge(i,l){1&i&&(e.j41(0,"div",42)(1,"div",13)(2,"div",14)(3,"label",15),e.EFF(4,"Fine Amount in AED"),e.j41(5,"span",16),e.EFF(6,"*"),e.k0s()(),e.nrm(7,"input",43),e.k0s(),e.j41(8,"div",14)(9,"label",15),e.EFF(10,"Frequency "),e.j41(11,"span",16),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",44),e.k0s(),e.j41(14,"div",14)(15,"label",15),e.EFF(16,"Frequency Per "),e.j41(17,"span",16),e.EFF(18,"*"),e.k0s()(),e.j41(19,"select",45)(20,"option",46),e.EFF(21,"Day"),e.k0s(),e.j41(22,"option",47),e.EFF(23,"Week"),e.k0s(),e.j41(24,"option",48),e.EFF(25,"Month"),e.k0s()()()(),e.j41(26,"div",13)(27,"div",14)(28,"label",15),e.EFF(29,"Warning Per "),e.j41(30,"span",16),e.EFF(31,"*"),e.k0s()(),e.j41(32,"select",49)(33,"option",46),e.EFF(34,"Day"),e.k0s(),e.j41(35,"option",47),e.EFF(36,"Week"),e.k0s()()(),e.j41(37,"div",14)(38,"label",15),e.EFF(39,"Warning "),e.j41(40,"span",16),e.EFF(41,"*"),e.k0s()(),e.nrm(42,"input",50),e.k0s(),e.j41(43,"div",14)(44,"label",15),e.EFF(45,"Penalty in % "),e.j41(46,"span",16),e.EFF(47,"*"),e.k0s()(),e.nrm(48,"input",51),e.k0s(),e.j41(49,"div",14)(50,"label",15),e.EFF(51,"Penalty Per "),e.j41(52,"span",16),e.EFF(53,"*"),e.k0s()(),e.j41(54,"select",52)(55,"option",46),e.EFF(56,"Day"),e.k0s(),e.j41(57,"option",47),e.EFF(58,"Week"),e.k0s()()()(),e.j41(59,"div",13)(60,"div",38)(61,"div",53),e.nrm(62,"input",54),e.j41(63,"label",55),e.EFF(64,"Reset by Violation"),e.k0s()()(),e.j41(65,"div",38)(66,"div",53),e.nrm(67,"input",56),e.j41(68,"label",57),e.EFF(69,"Reset by Period"),e.k0s()()()()())}function Te(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.goNext())}),e.EFF(1,"Next"),e.k0s()}}function Ae(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",59),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.goBack())}),e.EFF(1,"Back"),e.k0s()}}function De(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",58),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.submitForm())}),e.EFF(1,"Save"),e.k0s()}}let D=(()=>{class i{constructor(t,s,o,n,a,c){this.fb=t,this.activeModal=s,this.toastService=o,this.modalService=n,this.customerAdminService=a,this.appStateService=c,this.mode="create",this.sensorTypes=[],this.sensorGroupNameOptions={},this.sensorGroupNames=[],this.sensorParameters=[],this.customers=[],this.devices=[],this.showSensorParams=!1,this.sensorParamsEnabled=!1,this.selectedField=null,this.currentStep=1}ngOnInit(){this.userid=this.appStateService.getUser().user.id,this.customerId=this.appStateService.getUser().user.customer_id,this.organization_id=this.appStateService.getUser().user.organization_id,this.form=this.fb.group({step1:this.fb.group({sensorType:["",r.k0.required],sensorGroupName:["",r.k0.required],customerName:["",r.k0.required],deviceId:["",r.k0.required],deviceMake:["",r.k0.required],deviceModel:["",r.k0.required],deviceLatitude:["",r.k0.required],deviceLongitude:["",r.k0.required],sensorParameters:this.fb.array([])}),step2:this.fb.group({fineAmount:["",r.k0.required],frequency:["",r.k0.required],frequencyPer:["",r.k0.required],warningPer:["",r.k0.required],warning:["",r.k0.required],penaltyPercent:["",r.k0.required],penaltyPer:["",r.k0.required],resetType:["violation",r.k0.required]})}),this.loadInitialData()}loadInitialData(){Promise.all([this.getSensorTypes(),this.getAllCustomersForSensorGroupMapping(""),this.getAllDevicesForSensorGroupMapping()]).then(()=>{"edit"===this.mode&&this.data&&(this.handleEditMode(),this.loadSensorParameters(this.data.sensor_type,this.data.sensor_group))}).catch(t=>{console.error("Error loading initial data:",t),this.toastService.showError("Error loading form data")})}handleEditMode(){this.form.patchValue({step1:{sensorType:this.data.sensor_type,sensorGroupName:this.data.sensor_group,customerName:this.data.customer_id,deviceId:this.data.device_id,deviceMake:this.data.device_make,deviceModel:this.data.device_model,deviceLatitude:this.data.device_latitude,deviceLongitude:this.data.device_longitude},step2:{fineAmount:this.data.fine_amount,frequency:this.data.frequency,frequencyPer:this.data.frequency_per,warningPer:this.data.warning_per,warning:this.data.warning,penaltyPercent:this.data.penalty,penaltyPer:this.data.penalty_per,resetType:"violation"===this.data.reset_type?"violation":"period"}})}getSensorTypes(){return new Promise((t,s)=>{this.customerAdminService.getSensorGroupParameters(this.organization_id).subscribe(o=>{this.sensorTypes=o.data.map(n=>({sensor_type_id:n.sensortypeid,sensor_type:n.sensortype,sensorgroups:n.sensorgroups})),this.sensorGroupNameOptions={},this.sensorTypes.forEach(n=>{this.sensorGroupNameOptions[n.sensor_type_id]=n.sensorgroups.map(a=>({sensor_group_id:a.sensor_group_id,sensor_group_name:a.sensor_group_name}))}),t()},o=>{this.toastService.showError(o.message),s(o)})})}onSensorTypeChange(t){this.form.get("step1.sensorGroupName")?.reset(),this.sensorParametersArray.clear(),this.toggleSensorParams(!1),this.form.get("step1.deviceId")?.reset(),this.form.get("step1.deviceMake")?.reset(),this.form.get("step1.deviceModel")?.reset(),this.getAllDevicesForSensorGroupMapping()}onDeviceChange(t){if(console.log("Device selected:",t),console.log("Available devices:",this.devices),t){const s=this.devices.find(o=>o.id===t.id);console.log("Selected device:",s),s&&this.form.patchValue({step1:{deviceMake:s.device_make||"",deviceModel:s.device_model||""}})}else this.form.patchValue({step1:{deviceMake:"",deviceModel:""}})}get availableDevices(){return this.devices}createSensorParameter(t){return this.fb.group({sensorParameter:[t.sensor_parameter_name,r.k0.required],minThresholdLimit:[t.min_threshold_limit,r.k0.required],maxThresholdLimit:[t.max_threshold_limit,r.k0.required]})}get sensorParametersArray(){return this.form.get("step1.sensorParameters")}loadSensorParameters(t,s){this.sensorParametersArray.clear(),this.sensorTypes.forEach(o=>{o.sensor_type_id===t&&o.sensorgroups.forEach(n=>{n.sensor_group_id===s&&n.parameters.forEach(a=>{this.sensorParametersArray.push(this.createSensorParameter(a))})})})}toggleSensorParams(t){this.showSensorParams=t,this.sensorParamsEnabled=t,this.form.get("step1.sensorParameters"),console.log("sensorParametersArray:-------",this.sensorParametersArray)}getAllCustomersForSensorGroupMapping(t=""){return new Promise((s,o)=>{this.customerAdminService.getAllCustomersForSensorGroupMapping({page:1,limit:1e3,organization_id:this.organization_id}).subscribe(a=>{this.customers=a.results.data,s()},a=>{o(a)})})}getAllDevicesForSensorGroupMapping(){return new Promise((t,s)=>{console.log("Fetching devices for customer ID:",this.customerId),this.customerAdminService.getDeviceMappingDetails(this.customerId).subscribe(o=>{console.log("Device mapping response:",o);let n=[];if(o.result&&o.result.data?n=o.result.data:o.data?n=o.data:Array.isArray(o)&&(n=o),n&&n.length>0){const a=this.form.get("step1.sensorType")?.value;if(console.log("Selected sensor type:",a),a){const c=n.filter(f=>f.sensor_id===a);console.log("Filtered sensor type info:",c),this.devices=c.length>0?c.reduce((f,u)=>{try{let k;return k="string"==typeof u.devices?JSON.parse(u.devices):u.devices,Array.isArray(k)?[...f,...k]:k&&"object"==typeof k?[...f,k]:f}catch(k){return console.error("Error parsing device JSON:",k,u.devices),f}},[]):[]}else this.devices=n.reduce((c,f)=>{try{let u;return u="string"==typeof f.devices?JSON.parse(f.devices):f.devices,Array.isArray(u)?[...c,...u]:u&&"object"==typeof u?[...c,u]:c}catch(u){return console.error("Error parsing device JSON:",u,f.devices),c}},[])}else this.devices=[];console.log("Final processed devices:",this.devices),this.devices=this.devices.filter(a=>!(!a||!a.id)||(console.warn("Invalid device structure:",a),!1)),0===this.devices.length&&(console.log("No devices found for the selected criteria"),this.toastService.showInfo("No devices available for the selected sensor type")),t()},o=>{console.error("Error fetching devices:",o),this.devices=[],this.toastService.showError("Error loading devices"),s(o)})})}submitForm(){if(this.form.invalid)return void this.toastService.showError("Please fill all required fields");const t={sensor_type:this.form.value.step1.sensorType,sensor_group:this.form.value.step1.sensorGroupName,customer_id:this.form.value.step1.customerName,device_id:this.form.value.step1.deviceId,device_make:this.form.value.step1.deviceMake,device_model:this.form.value.step1.deviceModel,status:"active",created_by:this.userid,longitude:this.form.value.step1.deviceLongitude,latitude:this.form.value.step1.deviceLatitude,fine_amount:this.form.value.step2.fineAmount,frequency:this.form.value.step2.frequency,frequency_per:this.form.value.step2.frequencyPer,warning:this.form.value.step2.warning,warning_per:this.form.value.step2.warningPer,penalty:this.form.value.step2.penaltyPercent,penalty_per:this.form.value.step2.penaltyPer,reset_type:this.form.value.step2.resetType,organization_id:this.organization_id};"create"===this.mode?this.customerAdminService.createSensorGroupMapping(t).subscribe(s=>{s.success?this.toastService.showSuccess("Sensor group mapping saved successfully"):this.toastService.showError("Failed to save sensor group mapping"),this.activeModal.close("saved"),this.form.reset()},s=>{this.toastService.showError(s.error.message)}):this.customerAdminService.updateSensorGroupMapping(this.data.id,t).subscribe(s=>{s.success&&this.toastService.showSuccess("Sensor group mapping updated successfully"),this.activeModal.close("saved"),this.form.reset()},s=>{this.toastService.showError(s.error.message)})}openLocationModal(t){this.selectedField=t,this.modalService.open(Pe,{size:"lg",backdrop:"static",windowClass:"custom-modal-class"}).result.then(o=>{console.log("Coords:",o),o&&this.selectedField&&this.form.patchValue({step1:{deviceLatitude:o.lat,deviceLongitude:o.lng}})},()=>{})}goNext(){1===this.currentStep&&this.form.get("step1")?.invalid?this.toastService.showError("Please fill required fields in Step 1"):this.currentStep=2}goBack(){this.currentStep=1}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(r.ok),e.rXU(d.Lw),e.rXU(F.f),e.rXU(d.Bq),e.rXU(_),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-sensor-group-mapping-form"]],inputs:{mode:"mode",data:"data"},decls:16,vars:7,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],["formGroupName","step1"],[4,"ngIf"],["formGroupName","step2",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button","class","btn btn-secondary",3,"click",4,"ngIf"],[1,"row"],[1,"mb-3","col-md-3"],[1,"form-label","fw-bold"],[1,"text-danger"],["placeholder","Select Sensor Type","bindLabel","sensor_type","bindValue","sensor_type_id","formControlName","sensorType",1,"custom-ng-select",3,"items","clearable","change"],["placeholder","Select Sensor Group Name","formControlName","sensorGroupName","bindLabel","sensor_group_name","bindValue","sensor_group_id",1,"custom-ng-select",3,"items","clearable","change"],[1,"mb-3","col-md-3","d-flex","align-items-center"],[1,"form-label","fw-bold","me-2"],[3,"checked","change"],["class","sensor-params-section",4,"ngIf"],["formControlName","customerName","bindLabel","customer_name","bindValue","id","placeholder","Select Customer Name",1,"custom-ng-select",3,"items","clearable"],["formControlName","deviceId","bindLabel","device_id","bindValue","id","placeholder","Select Device ID",1,"custom-ng-select",3,"items","clearable","change"],["type","text","formControlName","deviceMake","placeholder","Device Make",1,"form-control"],["type","text","formControlName","deviceModel","placeholder","Device Model",1,"form-control"],["for","deviceLatitude",1,"form-label","fw-bold"],[1,"input-group"],["id","deviceLatitude","type","text","formControlName","deviceLatitude","placeholder","Device Latitude","readonly","",1,"form-control"],["type","button",1,"btn","btn-sm","location-btn","btn-outline-secondary",3,"click"],[1,"bi","bi-geo-alt-fill","text-danger"],["for","deviceLongitude",1,"form-label","fw-bold"],["id","deviceLongitude","type","text","formControlName","deviceLongitude","placeholder","Device Longitude","readonly","",1,"form-control"],[1,"sensor-params-section"],["formArrayName","sensorParameters"],["class","row align-items-end mb-3 parameter-block",3,"formGroupName","has-connector",4,"ngFor","ngForOf"],[1,"row","align-items-end","mb-3","parameter-block",3,"formGroupName"],[1,"col-md-3"],["type","text","formControlName","sensorParameter","placeholder","Sensor Parameter",1,"form-control"],["type","number","formControlName","minThresholdLimit",1,"form-control"],["type","number","formControlName","maxThresholdLimit",1,"form-control"],["formGroupName","step2"],["type","number","formControlName","fineAmount",1,"form-control"],["type","number","formControlName","frequency",1,"form-control"],["formControlName","frequencyPer",1,"form-control"],["value","DAY"],["value","WEEK"],["value","MONTH"],["formControlName","warningPer",1,"form-control"],["type","number","formControlName","warning",1,"form-control"],["type","number","formControlName","penaltyPercent",1,"form-control"],["formControlName","penaltyPer",1,"form-control"],[1,"form-check","form-check-inline"],["type","radio","formControlName","resetType","value","violation","id","resetViolation",1,"form-check-input"],["for","resetViolation",1,"form-check-label"],["type","radio","formControlName","resetType","value","period","id","resetPeriod",1,"form-check-input"],["for","resetPeriod",1,"form-check-label"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.activeModal.dismiss()}),e.k0s()(),e.j41(5,"div",4)(6,"form",5)(7,"div",6),e.DNE(8,Ne,65,11,"div",7),e.k0s(),e.DNE(9,Ge,70,0,"div",8),e.k0s()(),e.j41(10,"div",9)(11,"button",10),e.bIt("click",function(){return o.activeModal.dismiss()}),e.EFF(12," Cancel "),e.k0s(),e.DNE(13,Te,2,0,"button",11),e.DNE(14,Ae,2,0,"button",12),e.DNE(15,De,2,0,"button",11),e.k0s()()),2&s&&(e.R7$(3),e.SpI(" ","create"===o.mode?"Add Sensor Group Mapping":"Edit Sensor Group Mapping"," "),e.R7$(3),e.Y8G("formGroup",o.form),e.R7$(2),e.Y8G("ngIf",1===o.currentStep),e.R7$(1),e.Y8G("ngIf",2===o.currentStep),e.R7$(4),e.Y8G("ngIf",1===o.currentStep),e.R7$(1),e.Y8G("ngIf",2===o.currentStep),e.R7$(1),e.Y8G("ngIf",2===o.currentStep))},dependencies:[m.Sq,m.bT,r.qT,r.xH,r.y7,r.me,r.Q0,r.wz,r.Fm,r.BC,r.cb,r.j4,r.JD,r.$R,r.v8,h.ZP,g.vr,A.S],styles:[".input-group[_ngcontent-%COMP%]{flex-wrap:nowrap}.location-btn[_ngcontent-%COMP%]{height:33px}"]})}}return i})(),M=(()=>{class i{constructor(t,s,o){this.modalService=t,this.customerAdminService=s,this.appStateService=o,this.dropdownPlacement="top-start",this.userId=this.appStateService.getUser().user.id}agInit(t){this.params=t}onClick(t){t.stopPropagation()}refresh(){return!1}edit(){switch(console.log(this.params.staticLabel),this.params.staticLabel){case"customerAdmin":this.getCustomerAdminById(this.params);break;case"device":this.getDeviceById(this.params);break;case"sensorGrouping":this.getSensorGroupMappingById(this.params)}}delete(){C().fire({title:"Are you sure?",text:"You want to delete this customer admin?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel",customClass:{popup:"custom-swal",confirmButton:"swal2-confirm ",cancelButton:"swal2-cancel"}}).then(t=>{if(t.isConfirmed){console.log("Delete confirmed for:",this.params.data);let s=null;switch(this.params.staticLabel){case"customerAdmin":case"device":s=this.customerAdminService.deleteCustomer(this.params.data.id);break;case"sensorGrouping":s=this.customerAdminService.deleteSensorGroupMapping(this.params.data.id,{deleted_by:this.userId})}s&&s.subscribe(o=>{o.success?(C().fire("Deleted!","The record has been deleted.","success"),this.params.onActionCompleted?.("delete",this.params.data)):C().fire("Failed!","The record has not been deleted.","error")})}})}openModal(t,s,o=w){document.body.classList.add("modal-open-scroll-lock");const n=this.modalService.open(o,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class"});n.componentInstance.mode=t,n.componentInstance.data=s||null,n.result.then(a=>{"saved"===a&&(console.log("Customer admin created/updated."),this.params.onActionCompleted?.("edit",this.params.data)),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}getCustomerAdminById(t){this.customerAdminService.getCustomerById(t.data.id).subscribe(s=>{console.log(s.data),this.openModal("edit",s.data,w)})}getDeviceById(t){this.customerAdminService.getCustomerById(t.data.id).subscribe(s=>{console.log(s.data),this.openModal("edit",s.data,w)})}getSensorGroupMappingById(t){this.customerAdminService.getSensorGroupMappingById(t.data.id).subscribe(s=>{console.log(s.data),this.openModal("edit",s.data,D)})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(_),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-action-dropdown-renderer"]],decls:10,vars:0,consts:[["ngbDropdown","","container","body",1,"d-inline-block",3,"click"],["id","dropdownBasic1","ngbDropdownToggle","",1,"btn","btn-sm","btn-outline-primary","custom-dropdown-btn"],[1,"bi","bi-three-dots-vertical"],["ngbDropdownMenu","","aria-labelledby","dropdownBasic1",1,"dropdown-menu-custom"],["ngbDropdownItem","",3,"click"],[1,"bi","bi-pencil-square","me-2"],[1,"bi","bi-trash3","me-2"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.bIt("click",function(a){return o.onClick(a)}),e.j41(1,"button",1),e.nrm(2,"i",2),e.k0s(),e.j41(3,"div",3)(4,"button",4),e.bIt("click",function(){return o.edit()}),e.nrm(5,"i",5),e.EFF(6," Edit "),e.k0s(),e.j41(7,"button",4),e.bIt("click",function(){return o.delete()}),e.nrm(8,"i",6),e.EFF(9," Delete "),e.k0s()()())},dependencies:[d.tg,d.do,d.U0,d._H],styles:["[_nghost-%COMP%]{display:flex;justify-content:center}"]})}}return i})();var P=p(2688);let Me=(()=>{class i{constructor(t,s,o,n){this.http=t,this.modalService=s,this.customerAdminService=o,this.appStateService=n,this.pageSize=10,this.pageSizeSelector=[10,20,50,100],this.rowHeight=40,this.columnDefs=[{field:"customerId",headerName:"Customer ID"},{field:"customerName",headerName:"Customer Name"},{field:"planDetails",headerName:"Plan Name"},{field:"customerType",headerName:"Customer Type"},{field:"organization",headerName:"Organization Name"},{field:"contactPerson",headerName:"Contact Person Name"},{field:"contactNumber",headerName:"Contact Number"},{field:"email",headerName:"Email"},{field:"country",headerName:"Country"},{field:"currency",headerName:"Currency"},{field:"plotno",headerName:"Plot No, Street Name"},{field:"city",headerName:"City"},{field:"state",headerName:"State"},{field:"vat_id",headerName:"VAT ID"},{field:"trade_license_id",headerName:"Trade License ID"},{headerName:"Action",cellRenderer:M,suppressNavigable:!0,suppressKeyboardEvent:()=>!0,cellRendererParams:{suppressDoubleClickEdit:!0,staticLabel:"customerAdmin",onActionCompleted:(a,c)=>{("edit"===a||"delete"===a)&&this.getCustomers()}},cellClass:"no-select"}],this.defaultColDef={sortable:!0,filter:!0,resizable:!0},this.rowData=[]}ngOnInit(){this.userid=this.appStateService.getUser().user.id,this.organizationid=this.appStateService.getUser().user.organization_id,this.getCustomers()}getCustomers(t=""){this.customerAdminService.getCustomers({page:1,search:t,userid:this.userid,organization:this.organizationid}).subscribe(o=>{o.results.data.length>0&&(this.rowData=o.results.data.map(n=>({id:n.id,customerId:n.customer_id,customerName:n.customer_name,customerType:n.customer_type_name,organization:n.organization_name||"",contactPerson:n.contact_person_name||"",contactNumber:n.contact_number||"",email:n.email||"",planDetails:n.plan_name||"",currency:n.currency||"",plotno:n.address||"",city:n.city_name||"",state:n.state_name||"",country:n.country_name||"",vat_id:n.vat_id||"-",trade_license_id:n.trade_license_id||"-"})),this.gridApi.setRowCount(this.rowData.length))})}onGridReady(t){this.gridApi=t.api,setTimeout(()=>{document.querySelectorAll(".edit-action").forEach(s=>{s.addEventListener("click",o=>{o.preventDefault();const n=this.getRowFromElement(s);console.log("Edit clicked for row",n?.data)})}),document.querySelectorAll(".delete-action").forEach(s=>{s.addEventListener("click",o=>{o.preventDefault();const n=this.getRowFromElement(s);console.log("Delete clicked for row",n?.data)})})},0)}getRowFromElement(t){const o=t.closest(".ag-row")?.getAttribute("row-index");return this.gridApi?.getDisplayedRowAtIndex(Number(o))}onQuickFilterChanged(t){this.gridApi?this.getCustomers(t.target.value):console.warn("Grid API not available yet.")}onPaginationChanged(){if(!this.gridApi)return;const t=this.gridApi.paginationGetPageSize(),s=this.gridApi.paginationGetRowCount(),a=(Math.min(t,s),(t>=20?t+10:t)*this.rowHeight+100),c=document.querySelector(".ag-rakz-custom");c&&(c.style.height=`${a}px`)}openCustomerAdminModal(t,s){document.body.classList.add("modal-open-scroll-lock");const o=this.modalService.open(w,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class"});o.componentInstance.mode=t,o.componentInstance.data=s||null,o.componentInstance.modalRef=o,o.result.then(n=>{"saved"===n&&(console.log("Customer admin created/updated."),this.getCustomers()),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(j.Qq),e.rXU(d.Bq),e.rXU(_),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-customer-details"]],decls:10,vars:7,consts:[[1,"headSection"],[1,"leftHeadSection"],[1,"rightHeadSection"],[1,"searchBlock"],[1,"bi","bi-search"],["type","text","placeholder","Search",1,"formControlSearch",3,"input"],[1,"btn","outline-primaryBt","outline-primaryBt-custom",3,"click"],[1,"bodyContent"],["domLayout","autoHeight",1,"ag-theme-alpine","ag-rakz-custom",2,"width","100%",3,"theme","rowData","columnDefs","defaultColDef","pagination","paginationPageSize","paginationPageSizeSelector","paginationChanged","gridReady"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"i",4),e.j41(5,"input",5),e.bIt("input",function(a){return o.onQuickFilterChanged(a)}),e.k0s()(),e.j41(6,"button",6),e.bIt("click",function(){return o.openCustomerAdminModal("create")}),e.EFF(7,"Add Customer Admin"),e.k0s()()(),e.j41(8,"div",7)(9,"ag-grid-angular",8),e.bIt("paginationChanged",function(){return o.onPaginationChanged()})("gridReady",function(a){return o.onGridReady(a)}),e.k0s()()),2&s&&(e.R7$(9),e.Y8G("theme","legacy")("rowData",o.rowData)("columnDefs",o.columnDefs)("defaultColDef",o.defaultColDef)("pagination",!0)("paginationPageSize",o.pageSize)("paginationPageSizeSelector",o.pageSizeSelector))},dependencies:[P.xs]})}}return i})();var Re=p(547);function $e(i,l){if(1&i&&(e.j41(0,"option",22),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.sensortype," ")}}function Ue(i,l){if(1&i&&(e.j41(0,"ng-option",22),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.sensorParameter," ")}}function Le(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",31)(1,"button",32),e.bIt("click",function(){e.eBV(t);const o=e.XpG().index,n=e.XpG();return e.Njj(n.removeParameter(o))}),e.nrm(2,"i",33),e.k0s()()}}function ze(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",23)(1,"div",24)(2,"label",8),e.EFF(3," Sensor Parameter "),e.j41(4,"span",9),e.EFF(5,"*"),e.k0s()(),e.j41(6,"ng-select",25),e.bIt("change",function(o){const a=e.eBV(t).index,c=e.XpG();return e.Njj(c.onParameterSelect(o,a))}),e.DNE(7,Ue,2,2,"ng-option",14),e.k0s()(),e.j41(8,"div",26)(9,"label",8),e.EFF(10," Unit "),e.j41(11,"span",9),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",27),e.k0s(),e.j41(14,"div",24)(15,"label",8),e.EFF(16," Min Threshold Limit "),e.j41(17,"span",9),e.EFF(18,"*"),e.k0s()(),e.nrm(19,"input",28),e.k0s(),e.j41(20,"div",24)(21,"label",8),e.EFF(22," Max Threshold Limit "),e.j41(23,"span",9),e.EFF(24,"*"),e.k0s()(),e.nrm(25,"input",29),e.k0s(),e.DNE(26,Le,3,0,"div",30),e.k0s()}if(2&i){const t=l.index,s=e.XpG();e.AVh("has-connector",t<s.parameters.length-1),e.Y8G("formGroupName",t),e.R7$(7),e.Y8G("ngForOf",s.getAvailableParameters(t)),e.R7$(19),e.Y8G("ngIf",s.parameters.length>1)}}function Ye(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",34),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.addParameter())}),e.EFF(1," Add Parameter "),e.k0s()}}let qe=(()=>{class i{constructor(t,s,o,n,a,c){this.fb=t,this.activeModal=s,this.toastService=o,this.customerAdminService=n,this.superAdminService=a,this.appStateService=c,this.mode="create",this.type="create",this.sensors=[],this.parametersList=[]}ngOnInit(){this.form=this.fb.group({sensorGroupName:["",r.k0.required],sensorType:["",r.k0.required],parameters:this.fb.array([])}),this.getSensors(),this.addParameter(),this.customerId=this.appStateService.getUser().user.id,this.organizationId=this.appStateService.getUser().user.organization_id}getSensors(){this.superAdminService.getSensors().subscribe(t=>{this.sensors=t.data,"edit"===this.mode&&(this.form.patchValue({sensorGroupName:this.data.sensor_group_name,sensorType:this.data.sensor_type,parameters:this.data.parameters}),this.onSensorTypeChange(this.data.sensor_type))})}get parameters(){return this.form.get("parameters")}createParameter(t={}){return this.fb.group({sensorParameter:[t?.id||"",r.k0.required],unit:[t.unit||"",r.k0.required],minThreshold:[t.min_threshold_limit??"",[r.k0.required,r.k0.min(0)]],maxThreshold:[t.max_threshold_limit??"",[r.k0.required,r.k0.min(0)]]})}onSensorTypeChange(t){const s=t.target?.value||t;this.parameters.clear(),this.sensors.filter(o=>o.id===parseInt(s)).forEach(o=>{this.parametersList=o.parameters,"create"===this.mode?this.parametersList.forEach(n=>{this.parameters.push(this.createParameter(n))}):(this.data.parameters.forEach(n=>{const a=this.parametersList.find(c=>c.id===parseInt(n.sensor_parameter));a?(console.log(a),this.parameters.push(this.createParameter({...a,unit:n.unit,min_threshold_limit:n.min_threshold_limit,max_threshold_limit:n.max_threshold_limit}))):this.parameters.push(this.createParameter({id:n.sensor_parameter,name:n.sensor_parameter,unit:n.unit,min_threshold_limit:n.min_threshold_limit,max_threshold_limit:n.max_threshold_limit}))}),this.parameters.updateValueAndValidity())})}addParameter(t={}){this.parameters.push(this.createParameter(t))}removeParameter(t){this.parameters.removeAt(t),this.parameters.updateValueAndValidity()}onParameterSelect(t,s){const o=this.parametersList.find(n=>n.id===t);o&&this.parameters.at(s).patchValue({unit:o.unit||"",minThreshold:o.min_threshold_limit??"",maxThreshold:o.max_threshold_limit??""})}getAvailableParameters(t){const s=this.parameters.controls.map((o,n)=>n!==t?o.get("sensorParameter")?.value:null);return this.parametersList.filter(o=>!s.includes(o.id)||o.id===this.parameters.at(t).get("sensorParameter")?.value)}save(){this.form.valid?"create"===this.mode?this.customerAdminService.createSensorGroup({sensor_group_name:this.form.value.sensorGroupName,sensor_type:this.form.value.sensorType,parameters:this.form.value.parameters,created_by:this.customerId,organization_id:this.organizationId}).subscribe(()=>{this.toastService.showSuccess("Sensor Group saved successfully"),this.activeModal.close("saved")}):this.customerAdminService.updateSensorGroup(this.data.id,{sensor_group_name:this.form.value.sensorGroupName,sensor_type:this.form.value.sensorType,parameters:this.form.value.parameters,modified_by:this.customerId,organization_id:this.organizationId}).subscribe(()=>{this.toastService.showSuccess("Sensor Group updated successfully"),this.activeModal.close("saved")}):this.toastService.showError("Please fill all required fields")}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(r.ok),e.rXU(d.Lw),e.rXU(F.f),e.rXU(_),e.rXU(Re.Y),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-sensor-group-form"]],inputs:{mode:"mode",data:"data"},decls:33,vars:5,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[3,"formGroup"],[1,"row"],[1,"mb-3","col-md-3"],[1,"form-label","fw-bold"],[1,"text-danger"],["type","text","formControlName","sensorGroupName","placeholder","Sensor Group Name",1,"form-control"],[1,"mb-3","col-md-2"],["formControlName","sensorType",1,"form-control",3,"change"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-10"],["formArrayName","parameters"],["class","row align-items-end mb-3 parameter-block",3,"formGroupName","has-connector",4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-primary mt-2",3,"click",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[3,"value"],[1,"row","align-items-end","mb-3","parameter-block",3,"formGroupName"],[1,"col-md-3"],["formControlName","sensorParameter","placeholder","Select Parameter",1,"custom-ng-select","ng-select-width-100",3,"change"],[1,"col-md-2"],["type","text","formControlName","unit","placeholder","Unit",1,"form-control"],["type","number","formControlName","minThreshold","placeholder","Min Threshold",1,"form-control"],["type","number","formControlName","maxThreshold","placeholder","Max Threshold",1,"form-control"],["class","col-md-1 text-center",4,"ngIf"],[1,"col-md-1","text-center"],["type","button",1,"btn","btn-sm","btn-outline-danger","mb-2",3,"click"],[1,"bi","bi-trash"],["type","button",1,"btn","btn-outline-primary","mt-2",3,"click"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.activeModal.dismiss()}),e.k0s()(),e.j41(5,"div",4)(6,"form",5)(7,"div",6)(8,"div",7)(9,"label",8),e.EFF(10," Sensor Group Name "),e.j41(11,"span",9),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",10),e.k0s()(),e.j41(14,"div",6)(15,"div",11)(16,"label",8),e.EFF(17," Sensor Type "),e.j41(18,"span",9),e.EFF(19,"*"),e.k0s()(),e.j41(20,"select",12),e.bIt("change",function(a){return o.onSensorTypeChange(a)}),e.j41(21,"option",13),e.EFF(22,"Select Sensor Type"),e.k0s(),e.DNE(23,$e,2,2,"option",14),e.k0s()(),e.j41(24,"div",15)(25,"div",16),e.DNE(26,ze,27,5,"div",17),e.k0s()()(),e.DNE(27,Ye,2,0,"button",18),e.k0s()(),e.j41(28,"div",19)(29,"button",20),e.bIt("click",function(){return o.activeModal.dismiss()}),e.EFF(30," Cancel "),e.k0s(),e.j41(31,"button",21),e.bIt("click",function(){return o.save()}),e.EFF(32,"Save"),e.k0s()()()),2&s&&(e.R7$(3),e.SpI(" ","create"===o.type?"Add Sensor Group":"Edit Sensor Group"," "),e.R7$(3),e.Y8G("formGroup",o.form),e.R7$(17),e.Y8G("ngForOf",o.sensors),e.R7$(3),e.Y8G("ngForOf",o.parameters.controls),e.R7$(1),e.Y8G("ngIf",o.parameters.length<o.parametersList.length))},dependencies:[m.Sq,m.bT,r.qT,r.xH,r.y7,r.me,r.Q0,r.wz,r.BC,r.cb,r.j4,r.JD,r.$R,r.v8,h.ZP,g.vr,g.xt]})}}return i})();function Oe(i,l){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"div",11)(2,"div",12)(3,"div",13),e.nrm(4,"img",14),e.k0s(),e.j41(5,"div",15),e.nrm(6,"img",16),e.j41(7,"h5",17),e.EFF(8),e.k0s(),e.j41(9,"div",18)(10,"button",19),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(),c=e.sdS(12);return e.Njj(a.openViewModal(c,n))}),e.EFF(11,"View"),e.k0s(),e.j41(12,"button",19),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.openSensorGroupModal("edit",n))}),e.EFF(13,"Update"),e.k0s(),e.j41(14,"button",19),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG();return e.Njj(a.deleteSensorGroup(n))}),e.EFF(15,"Delete"),e.k0s()()()()(),e.bVm()}if(2&i){const t=l.$implicit;e.R7$(4),e.FS9("src","Water"===t.sensor_name?"assets/water-img.jpg":"assets/air-img.jpg",e.B4B),e.R7$(2),e.FS9("src","Water"===t.sensor_name?"assets/water-icon.jpg":"assets/air-icon.jpg",e.B4B),e.R7$(2),e.JRh(t.sensor_group_name)}}function xe(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",20)(1,"h4",21),e.EFF(2),e.k0s(),e.j41(3,"button",22),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.dismiss("Cross click"))}),e.k0s()(),e.j41(4,"div",23)(5,"div",24)(6,"div",25)(7,"div",26)(8,"div",27),e.nrm(9,"i",4),e.j41(10,"input",5),e.bIt("input",function(o){e.eBV(t);const n=e.XpG();return e.Njj(n.searchParameter(o))}),e.k0s()()()()(),e.j41(11,"ag-grid-angular",28),e.bIt("paginationChanged",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.onPaginationChanged())}),e.k0s()()}if(2&i){const t=e.XpG();e.R7$(2),e.SpI("",t.selectedSensorGroup," Sensor Parameter Details"),e.R7$(9),e.Y8G("theme","legacy")("rowData",t.rowData)("columnDefs",t.columnDefs)("defaultColDef",t.defaultColDef)("pagination",!0)("paginationPageSize",t.pageSize)("paginationPageSizeSelector",t.pageSizeSelector)("paginationAutoPageSize",!0)}}let Be=(()=>{class i{constructor(t,s,o,n){this.modalService=t,this.customerAdminService=s,this.toastService=o,this.appStateService=n,this.sensorGroups=[],this.sensorParameters=[],this.pageSize=10,this.pageSizeSelector=[10,20,50,100],this.rowHeight=40,this.sensorGroupsList=[],this.columnDefs=[{field:"sensor_parameter_name",headerName:"Parameter"},{field:"unit",headerName:"Units"},{field:"min_threshold_limit",headerName:"Min Threshold Limit"},{field:"max_threshold_limit",headerName:"Max Threshold Limit"}],this.defaultColDef={sortable:!0,filter:!0,resizable:!0},this.rowData=[]}ngOnInit(){this.getSensorGroups(),this.customerId=this.appStateService.getUser().user.id}getSensorGroups(){const t={organization_id:this.appStateService.getUser().user.organization_id};this.customerAdminService.getSensorGroups(t).subscribe(s=>{console.log(s),this.sensorGroups=s.data,this.sensorGroupsList=this.sensorGroups})}openSensorGroupModal(t,s){document.body.classList.add("modal-open-scroll-lock");const o=this.modalService.open(qe,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class modal-1024px"});console.log(s),o.componentInstance.mode=t,o.componentInstance.data=s||null,o.result.then(n=>{"saved"===n&&(console.log("Sensor created/updated."),this.getSensorGroups()),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}searchParameter(t){const s=t.target.value;this.sensorParameters=this.selectedSensor.parameters.filter(o=>o.sensor_parameter_name.toLowerCase().includes(s.toLowerCase())),this.rowData=this.sensorParameters,this.gridApi.setRowCount(this.rowData.length)}onPaginationChanged(){if(!this.gridApi)return;const t=this.gridApi.paginationGetPageSize(),s=this.gridApi.paginationGetRowCount(),a=(Math.min(t,s),(t>=20?t+10:t)*this.rowHeight+100),c=document.querySelector(".ag-rakz-custom");c&&(c.style.height=`${a}px`)}openViewModal(t,s){this.selectedSensor=s,this.selectedSensorGroup=s.sensor_group_name,this.sensorParameters=s.parameters,this.rowData=this.sensorParameters.sort((o,n)=>o.id-n.id),this.modalService.open(t,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class modal-900px"})}deleteSensorGroup(t){C().fire({title:"Are you sure?",text:"You want to delete this sensor group?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel",customClass:{popup:"custom-swal",confirmButton:"swal2-confirm ",cancelButton:"swal2-cancel"}}).then(s=>{if(s.isConfirmed){console.log("Delete confirmed for:",t);let o=null;o=this.customerAdminService.deleteSensorGroup({modified_by:this.customerId},t.id),o&&o.subscribe(a=>{a.success?(C().fire("Deleted!","The sensor group has been deleted.","success"),this.getSensorGroups()):C().fire("Failed!","The sensor group has not been deleted.","error")})}})}searchSensorGroup(t){const s=t.target.value;this.sensorGroups=this.sensorGroupsList.filter(o=>o.sensor_group_name.toLowerCase().includes(s.toLowerCase()))}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(_),e.rXU(F.f),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-sensor-group"]],decls:13,vars:1,consts:[[1,"headSection"],[1,"leftHeadSection"],[1,"rightHeadSection"],[1,"searchBlock"],[1,"bi","bi-search"],["type","text","placeholder","Search",1,"formControlSearch",3,"input"],[1,"btn","outline-primaryBt",3,"click"],[1,"bodyContent","sensorParaManWrapp"],[1,"row","mt-4","justify-content-md-center"],[4,"ngFor","ngForOf"],["noiseViewModal",""],[1,"col-md-3"],[1,"card"],[1,"cardImgSPM"],["alt","noise",1,"img-fluid",3,"src"],[1,"card-body"],["alt","noise",1,"noiseIconSPM",3,"src"],[1,"card-title","text-center"],[1,"sPMcardBt"],[1,"btn","textPrimaryBt",3,"click"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-12"],[1,"pull-right"],[1,"searchBlock","mb-3"],["domLayout","autoHeight",1,"ag-theme-alpine","ag-rakz-custom",2,"width","100%",3,"theme","rowData","columnDefs","defaultColDef","pagination","paginationPageSize","paginationPageSizeSelector","paginationAutoPageSize","paginationChanged"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"i",4),e.j41(5,"input",5),e.bIt("input",function(a){return o.searchSensorGroup(a)}),e.k0s()(),e.j41(6,"button",6),e.bIt("click",function(){return o.openSensorGroupModal("create")}),e.EFF(7,"Add Sensor Group"),e.k0s()()(),e.j41(8,"div",7)(9,"div",8),e.DNE(10,Oe,16,3,"ng-container",9),e.k0s()(),e.DNE(11,xe,12,9,"ng-template",null,10,e.C5r)),2&s&&(e.R7$(10),e.Y8G("ngForOf",o.sensorGroups))},dependencies:[m.Sq,P.xs]})}}return i})(),Ve=(()=>{class i{constructor(t,s,o,n){this.modalService=t,this.customerAdminService=s,this.toastService=o,this.appStateService=n,this.columnDefs=[{headerName:"Id",field:"id",sortable:!0,filter:!0,hide:!0},{headerName:"Device ID",field:"deviceId",sortable:!0,filter:!0},{headerName:"Customer Name",field:"customer_name",sortable:!0,filter:!0},{headerName:"Sensor Group Name",field:"sensor_group_name",sortable:!0,filter:!0},{headerName:"Sensor Type",field:"sensortype",sortable:!0,filter:!0},{headerName:"Make",field:"devicemake",sortable:!0,filter:!0},{headerName:"Model",field:"devicemodel",sortable:!0,filter:!0},{headerName:"Fine Amount",field:"fine_amount",sortable:!0,filter:!0},{headerName:"Penalty Percentage",field:"penalty",sortable:!0,filter:!0},{headerName:"Penalty Duration",field:"penalty_per",sortable:!0,filter:!0},{headerName:"Frequency Count",field:"frequency",sortable:!0,filter:!0},{headerName:"Frequency Duration",field:"frequency_per",sortable:!0,filter:!0},{headerName:"Warning Count",field:"warning",sortable:!0,filter:!0},{headerName:"Warning Duration",field:"warning_per",sortable:!0,filter:!0},{headerName:"Reset By",field:"reset_type",sortable:!0,filter:!0},{headerName:"Latitude",field:"device_latitude",sortable:!0,filter:!0},{headerName:"Longitude",field:"device_longitude",sortable:!0,filter:!0},{headerName:"Action",cellRenderer:M,suppressNavigable:!0,suppressKeyboardEvent:()=>!0,cellRendererParams:{suppressDoubleClickEdit:!0,staticLabel:"sensorGrouping",onActionCompleted:(a,c)=>{("edit"===a||"delete"===a)&&this.getSensorGroupMappings()}},cellClass:"no-select"}],this.defaultColDef={resizable:!0,sortable:!0,filter:!0},this.rowData=[],this.pageSize=10,this.pageSizeSelector=[10,10,20]}ngOnInit(){this.getSensorGroupMappings()}getSensorGroupMappings(){const t={organization_id:this.appStateService.getUser().user.organization_id};this.customerAdminService.getSensorGroupMappings(t).subscribe(s=>{this.rowData=s.data,console.log(this.rowData)})}onGridReady(t){this.gridApi=t.api}onQuickFilterChanged(t){this.gridApi||console.warn("Grid API not available yet.")}onPaginationChanged(){}openSensorGroupingModal(t,s){document.body.classList.add("modal-open-scroll-lock");const o=this.modalService.open(D,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class modal-1024px"});o.componentInstance.mode=t,o.componentInstance.data=s||null,o.result.then(n=>{"saved"===n&&(console.log("Sensor group created/updated."),this.getSensorGroupMappings()),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(_),e.rXU(F.f),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-sensor-grouping"]],decls:10,vars:7,consts:[[1,"headSection"],[1,"leftHeadSection"],[1,"rightHeadSection"],[1,"searchBlock"],[1,"bi","bi-search"],["type","text","placeholder","Search",1,"formControlSearch",3,"input"],[1,"btn","outline-primaryBt","outline-primaryBt-custom",3,"click"],[1,"bodyContent"],["domLayout","autoHeight",1,"ag-theme-alpine","ag-rakz-custom",2,"width","100%",3,"theme","rowData","columnDefs","defaultColDef","pagination","paginationPageSize","paginationPageSizeSelector","paginationChanged","gridReady"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"i",4),e.j41(5,"input",5),e.bIt("input",function(a){return o.onQuickFilterChanged(a)}),e.k0s()(),e.j41(6,"button",6),e.bIt("click",function(){return o.openSensorGroupingModal("create")}),e.EFF(7," Add Sensor Group Mapping "),e.k0s()()(),e.j41(8,"div",7)(9,"ag-grid-angular",8),e.bIt("paginationChanged",function(){return o.onPaginationChanged()})("gridReady",function(a){return o.onGridReady(a)}),e.k0s()()),2&s&&(e.R7$(9),e.Y8G("theme","legacy")("rowData",o.rowData)("columnDefs",o.columnDefs)("defaultColDef",o.defaultColDef)("pagination",!0)("paginationPageSize",o.pageSize)("paginationPageSizeSelector",o.pageSizeSelector))},dependencies:[P.xs]})}}return i})();function Xe(i,l){1&i&&(e.j41(0,"div",26),e.EFF(1," Enter plan name "),e.k0s())}function He(i,l){1&i&&(e.j41(0,"div",26),e.EFF(1," Enter currency "),e.k0s())}function Je(i,l){1&i&&(e.j41(0,"div",26),e.EFF(1," Enter valid price (only numbers and 2 decimal places) "),e.k0s())}function Ze(i,l){if(1&i&&(e.j41(0,"option",27),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.Y8G("value",t.id),e.R7$(1),e.SpI(" ",t.period," ")}}function We(i,l){1&i&&(e.j41(0,"div",26),e.EFF(1," Select period "),e.k0s())}function Qe(i,l){1&i&&e.EFF(0),2&i&&e.SpI(" ",l.item.payment_provider," ")}function Ke(i,l){1&i&&e.EFF(0),2&i&&e.SpI(" ",l.item.payment_provider," ")}function et(i,l){1&i&&(e.j41(0,"div",26),e.EFF(1," Select payment provider "),e.k0s())}function tt(i,l){if(1&i){const t=e.RV6();e.j41(0,"button",31),e.bIt("click",function(){e.eBV(t);const o=e.XpG().index,n=e.XpG();return e.Njj(n.removeDescription(o))}),e.nrm(1,"i",32),e.k0s()}}const S=function(i){return{"is-invalid":i}};function ot(i,l){if(1&i&&(e.j41(0,"div",28),e.nrm(1,"input",29),e.DNE(2,tt,2,0,"button",30),e.k0s()),2&i){const t=l.$implicit,s=l.index,o=e.XpG();let n;e.Y8G("formGroupName",s),e.R7$(1),e.Y8G("ngClass",e.eq3(3,S,(null==(n=t.get("description"))?null:n.invalid)&&((null==(n=t.get("description"))?null:n.touched)||(null==(n=t.get("description"))?null:n.dirty)))),e.R7$(1),e.Y8G("ngIf",o.descriptions.length>1)}}let st=(()=>{class i{constructor(t,s,o,n,a){this.activeModal=t,this.fb=s,this.customerAdminService=o,this.appStateService=n,this.toastService=a,this.mode="create",this.formSubmitted=!1,this.userId=0,this.periods=[{id:1,period:"Monthly"},{id:2,period:"Yearly"}],this.paymentProviders=[{id:1,payment_provider:"Stripe"}],this.organizationId=0}ngOnInit(){this.userId=this.appStateService.getUser().user.id,this.organizationId=this.appStateService.getUser().user.organization_id,this.buildSubscriptionForm(),"edit"===this.mode&&(this.subscriptionForm.patchValue({planName:this.data.plan_name,currency:this.data.currency,price:this.data.price,period:this.periods.find(t=>t.period===this.data.period)?.id,paymentProvider:this.paymentProviders.find(t=>t.payment_provider===this.data.payment_provider)?.id,status:this.data.status}),this.descriptions.clear(),this.data.descriptions.forEach(t=>{this.addDescription(),this.descriptions.at(this.descriptions.length-1).patchValue({description:t})}))}buildSubscriptionForm(){this.subscriptionForm=this.fb.group({planName:["",r.k0.required],currency:["AED",r.k0.required],price:["",[r.k0.required,r.k0.pattern(/^[0-9]+(\.[0-9]{1,2})?$/)]],period:["",r.k0.required],paymentProvider:["",r.k0.required],descriptions:this.fb.array([this.createDescriptionField()]),status:["active"]})}createDescriptionField(){return this.fb.group({description:["",r.k0.required]})}get descriptions(){return this.subscriptionForm.get("descriptions")}addDescription(){this.descriptions.push(this.createDescriptionField())}removeDescription(t){this.descriptions.removeAt(t)}isFieldInvalid(t){const s=this.subscriptionForm.get(t);return!(!s||!s.touched&&!this.formSubmitted||!s.invalid)}onSubmit(){this.formSubmitted=!0,this.subscriptionForm.valid&&("create"===this.mode?(this.customerAdminService.createSubscription({plan_name:this.subscriptionForm.value.planName,currency:this.subscriptionForm.value.currency,price:this.subscriptionForm.value.price,period:this.subscriptionForm.value.period,payment_provider:this.subscriptionForm.value.paymentProvider,descriptions:this.subscriptionForm.value.descriptions,status:this.subscriptionForm.value.status,created_by:this.userId,organization_id:this.organizationId}).subscribe(s=>{s.success?(this.toastService.showSuccess("Subscription created successfully"),this.activeModal.close("saved")):this.toastService.showError("Failed to create subscription")},s=>{this.toastService.showError(s.error.message)}),this.subscriptionForm.reset(),this.formSubmitted=!1):"edit"===this.mode&&(this.customerAdminService.updateSubscription(this.data.id,{plan_name:this.subscriptionForm.value.planName,currency:this.subscriptionForm.value.currency,price:this.subscriptionForm.value.price,period:this.subscriptionForm.value.period,payment_provider:this.subscriptionForm.value.paymentProvider,descriptions:this.subscriptionForm.value.descriptions,status:this.subscriptionForm.value.status,modified_by:this.userId,organization_id:this.organizationId}).subscribe(s=>{s.success?(this.toastService.showSuccess("Subscription updated successfully"),this.activeModal.close("saved")):this.toastService.showError("Failed to update subscription")},s=>{this.toastService.showError(s.error.message)}),this.subscriptionForm.reset(),this.formSubmitted=!1))}close(){this.activeModal.dismiss()}removeInvalidChars(t){const s=t.target;s.value=s.value.replace(/[^a-zA-Z0-9]/g,""),this.subscriptionForm.get("planName")?.setValue(s.value)}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Lw),e.rXU(r.ok),e.rXU(_),e.rXU(b.i),e.rXU(F.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-customer-admin-form"]],inputs:{mode:"mode",data:"data"},decls:62,vars:28,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["novalidate","",3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[1,"col-md-12","mb-2"],[1,"text-danger"],["type","text","formControlName","planName","maxlength","30","placeholder","Enter Plan Name",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","currency","maxlength","30","placeholder","Enter Currency","readonly","",1,"form-control","disabled",3,"ngClass"],["type","text","formControlName","price","placeholder","Enter Price","maxlength","30","pattern","^[0-9]+(\\.[0-9]{1,2})?$",1,"form-control",3,"ngClass"],["formControlName","period",1,"form-control",3,"ngClass"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["bindLabel","payment_provider","bindValue","id","formControlName","paymentProvider","placeholder","Select Payment Provider",1,"custom-currency-select",3,"items","searchable","clearable","ngClass"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"col-md-11","mb-2"],["formArrayName","descriptions"],["class","mb-2 position-relative",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary","btn-sm","mt-2",3,"click"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"invalid-feedback"],[3,"value"],[1,"mb-2","position-relative",3,"formGroupName"],["type","text","formControlName","description","placeholder","Enter description",1,"form-control","pe-5",3,"ngClass"],["type","button","class","btn btn-sm btn-link text-danger position-absolute top-50  translate-middle-y me-2 delete-button-position-right delete-icon-size",3,"click",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-link","text-danger","position-absolute","top-50","translate-middle-y","me-2","delete-button-position-right","delete-icon-size",3,"click"],[1,"bi","bi-trash"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.close()}),e.k0s()(),e.j41(5,"form",4),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",5)(7,"div",6)(8,"div",7)(9,"label"),e.EFF(10,"Plan Name "),e.j41(11,"span",8),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",9),e.DNE(14,Xe,2,0,"div",10),e.k0s(),e.j41(15,"div",7)(16,"label"),e.EFF(17,"Currency "),e.j41(18,"span",8),e.EFF(19,"*"),e.k0s()(),e.nrm(20,"input",11),e.DNE(21,He,2,0,"div",10),e.k0s(),e.j41(22,"div",7)(23,"label"),e.EFF(24,"Price "),e.j41(25,"span",8),e.EFF(26,"*"),e.k0s()(),e.nrm(27,"input",12),e.DNE(28,Je,2,0,"div",10),e.k0s(),e.j41(29,"div",7)(30,"label"),e.EFF(31,"Period "),e.j41(32,"span",8),e.EFF(33,"*"),e.k0s()(),e.j41(34,"select",13)(35,"option",14),e.EFF(36,"Select Period"),e.k0s(),e.DNE(37,Ze,2,2,"option",15),e.k0s(),e.DNE(38,We,2,0,"div",10),e.k0s(),e.j41(39,"div",7)(40,"label"),e.EFF(41,"Payment Provider "),e.j41(42,"span",8),e.EFF(43,"*"),e.k0s()(),e.j41(44,"ng-select",16),e.DNE(45,Qe,1,1,"ng-template",17),e.DNE(46,Ke,1,1,"ng-template",18),e.k0s(),e.DNE(47,et,2,0,"div",10),e.k0s(),e.j41(48,"div",19)(49,"label"),e.EFF(50,"Description(s) "),e.j41(51,"span",8),e.EFF(52,"*"),e.k0s()(),e.j41(53,"div",20),e.DNE(54,ot,3,5,"div",21),e.k0s(),e.j41(55,"button",22),e.bIt("click",function(){return o.addDescription()}),e.EFF(56," Add Line "),e.k0s()()()(),e.j41(57,"div",23)(58,"button",24),e.bIt("click",function(){return o.close()}),e.EFF(59,"Cancel"),e.k0s(),e.j41(60,"button",25),e.EFF(61,"Save"),e.k0s()()()()),2&s&&(e.R7$(3),e.SpI(" ","edit"===o.mode?"Update Plan Details":"Add Plan Details"," "),e.R7$(2),e.Y8G("formGroup",o.subscriptionForm),e.R7$(8),e.Y8G("ngClass",e.eq3(18,S,o.isFieldInvalid("planName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("planName")),e.R7$(6),e.Y8G("ngClass",e.eq3(20,S,o.isFieldInvalid("currency"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("currency")),e.R7$(6),e.Y8G("ngClass",e.eq3(22,S,o.isFieldInvalid("price"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("price")),e.R7$(6),e.Y8G("ngClass",e.eq3(24,S,o.isFieldInvalid("period"))),e.R7$(3),e.Y8G("ngForOf",o.periods),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("period")),e.R7$(6),e.Y8G("items",o.paymentProviders)("searchable",!0)("clearable",!0)("ngClass",e.eq3(26,S,o.isFieldInvalid("paymentProvider"))),e.R7$(3),e.Y8G("ngIf",o.isFieldInvalid("paymentProvider")),e.R7$(7),e.Y8G("ngForOf",o.descriptions.controls),e.R7$(6),e.Y8G("disabled",o.subscriptionForm.invalid))},dependencies:[m.YU,m.Sq,m.bT,r.qT,r.xH,r.y7,r.me,r.wz,r.BC,r.cb,r.tU,r.R_,r.j4,r.JD,r.$R,r.v8,h.ZP,g.vr,g.Uq,g.ZZ]})}}return i})();function it(i,l){if(1&i&&(e.j41(0,"li"),e.EFF(1),e.k0s()),2&i){const t=l.$implicit;e.R7$(1),e.JRh(t)}}function nt(i,l){if(1&i){const t=e.RV6();e.qex(0),e.j41(1,"div",8)(2,"div",9)(3,"div",10)(4,"div",11)(5,"h2"),e.EFF(6),e.k0s(),e.j41(7,"button",12),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.deleteSubscription(n))}),e.nrm(8,"i",13),e.k0s()(),e.j41(9,"div",14)(10,"h3"),e.nrm(11,"i",15),e.EFF(12),e.k0s()(),e.j41(13,"div",16)(14,"h6"),e.EFF(15,"This plan includes :"),e.k0s(),e.j41(16,"ul"),e.DNE(17,it,2,1,"li",7),e.k0s()(),e.j41(18,"div",17)(19,"button",18),e.bIt("click",function(){const n=e.eBV(t).$implicit,a=e.XpG(2);return e.Njj(a.openSubscriptionModal("edit",n))}),e.EFF(20,"Update "),e.nrm(21,"i",19),e.k0s()()()()(),e.bVm()}if(2&i){const t=l.$implicit;e.R7$(6),e.SpI("",t.plan_name," Plan"),e.R7$(6),e.E5c(" ",t.currency," ",t.price," / ",t.period,""),e.R7$(5),e.Y8G("ngForOf",t.descriptions)}}function rt(i,l){if(1&i&&(e.j41(0,"div",6),e.DNE(1,nt,22,5,"ng-container",7),e.k0s()),2&i){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.subscriptions)}}let at=(()=>{class i{constructor(t,s,o){this.modalService=t,this.customerAdminService=s,this.appStateService=o,this.subscriptions=[],this.userId=0,this.organizationId=0}ngOnInit(){this.userId=this.appStateService.getUser().user.id,this.organizationId=this.appStateService.getUser().user.organization_id,this.getSubscriptions()}getSubscriptions(){this.customerAdminService.getSubscriptions({customer_id:this.appStateService.getUser().user?.id,organization:this.appStateService.getUser().user.organization_id}).subscribe(t=>{this.subscriptions=t.data})}openSubscriptionModal(t,s){document.body.classList.add("modal-open-scroll-lock");const o=this.modalService.open(st,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class"});o.componentInstance.mode=t,o.componentInstance.data=s||null,o.result.then(n=>{"saved"===n&&(console.log("Subscription created/updated."),this.getSubscriptions()),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}deleteSubscription(t){C().fire({title:"Are you sure?",text:"You want to delete this subscription?",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",cancelButtonText:"No, cancel",customClass:{popup:"custom-swal",confirmButton:"swal2-confirm ",cancelButton:"swal2-cancel"}}).then(s=>{if(s.isConfirmed){console.log("Delete confirmed for:",t);let o={id:t.id,modified_by:this.appStateService.getUser().user.id},n=this.customerAdminService.deleteSubscription(o);n&&n.subscribe(a=>{a.success?(C().fire("Deleted!","The record has been deleted.","success"),this.getSubscriptions()):C().fire("Failed!","The record has not been deleted.","error")})}})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(_),e.rXU(b.i))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-subscriptions"]],decls:7,vars:1,consts:[[1,"headSection"],[1,"leftHeadSection"],[1,"rightHeadSection"],[1,"btn","outline-primaryBt",3,"click"],[1,"bodyContent"],["class","row subscriptionWrapp justify-content-md-center mt-4",4,"ngIf"],[1,"row","subscriptionWrapp","justify-content-md-center","mt-4"],[4,"ngFor","ngForOf"],[1,"col-lg-3","col-md-4","col-sm-6","subscriptionCol"],[1,"card"],[1,"card-body"],[1,"card-title"],["type","button",1,"btn","btnIconInput","deleteIconBt",3,"click"],[1,"bi","bi-trash-fill"],[1,"cardHeading"],[1,"bi","bi-star-half"],[1,"card-text"],[1,"card-footer"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-pencil-fill"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"button",3),e.bIt("click",function(){return o.openSubscriptionModal("create")}),e.EFF(4,"Add Subscription"),e.k0s()()(),e.j41(5,"div",4),e.DNE(6,rt,2,1,"div",5),e.k0s()),2&s&&(e.R7$(6),e.Y8G("ngIf",o.subscriptions.length>0))},dependencies:[m.Sq,m.bT]})}}return i})(),lt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-reports"]],decls:2,vars:0,template:function(s,o){1&s&&(e.j41(0,"p"),e.EFF(1,"reports works!"),e.k0s())}})}}return i})();function ct(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter customer admin name "),e.k0s())}function dt(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter organization name "),e.k0s())}function mt(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter contact person name "),e.k0s())}function ut(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter valid email "),e.k0s())}function pt(i,l){1&i&&(e.j41(0,"div")(1,"small",8),e.EFF(2,"Enter contact number"),e.k0s()())}function ht(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter customer admin type "),e.k0s())}function gt(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Enter address "),e.k0s())}function ft(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Select country "),e.k0s())}function vt(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Select state "),e.k0s())}function _t(i,l){1&i&&(e.j41(0,"div",25),e.EFF(1," Select city "),e.k0s())}const y=function(i){return{"is-invalid":i}},bt=function(i,l){return[i,l]};let Ft=(()=>{class i{constructor(t,s,o){this.fb=t,this.customerAdminService=s,this.toastService=o,this.mode="create",this.SearchCountryField="all",this.selectedCountryISO="IN",this.formSubmitted=!1,this.countries=[],this.states=[],this.cities=[],this.currencyList=[],this.customerTypes=[],this.preferredCountries=[h.ij.India,h.ij.UnitedStates]}ngOnInit(){this.initializeForm(),this.getCurrencies(),this.getCustomerTypes(),this.getCountries(),this.data&&(this.profileForm.patchValue({customerAdminName:this.data.customer_admin_name,organizationName:this.data.organization_name,contactPersonName:this.data.contact_person_name,customerAdminType:this.data.cust_admin_type,email:this.data.email,contactNumber:JSON.parse(this.data.contact_object).number,address:this.data.address,country:this.data.country_id,state:this.data.state_id,city:this.data.city_id}),this.selectedCountry=this.data.country_id,this.getStates(),this.selectedState=this.data.state_id,this.getCities(),this.selectedCity=this.data.city_id,this.selectedCountryISO=JSON.parse(this.data.contact_object).countryCode)}initializeForm(){this.profileForm=this.fb.group({customerAdminName:["",[r.k0.required]],organizationName:["",[r.k0.required]],contactPersonName:["",[r.k0.required]],customerAdminType:["",[r.k0.required]],email:["",[r.k0.required,r.k0.email]],contactNumber:["",[r.k0.required]],address:["",[r.k0.required]],country:["",[r.k0.required]],state:["",[r.k0.required]],city:["",[r.k0.required]]})}isFieldInvalid(t){const s=this.profileForm.get(t);return!(!s||!s.invalid||!s.touched&&!this.formSubmitted)}getCurrencies(){this.customerAdminService.getCurrencies().subscribe(t=>{this.currencyList=t.data})}getCustomerTypes(){this.customerAdminService.getCustomerTypes().subscribe(t=>{this.customerTypes=t.data})}getCountries(){this.customerAdminService.getCountries().subscribe(t=>{this.countries=t.data})}getStates(){this.selectedState=null,this.customerAdminService.getStates(this.selectedCountry).subscribe(t=>{this.states=t.data})}getCities(){this.selectedCity=null,this.customerAdminService.getCities(this.selectedState).subscribe(t=>{this.cities=t.data})}onSubmit(){if(this.formSubmitted=!0,this.profileForm.valid){console.log("Profile Data:",this.profileForm.value);const t={customer_admin_name:this.profileForm.value.customerAdminName,organization_name:this.profileForm.value.organizationName,contact_person_name:this.profileForm.value.contactPersonName,cust_admin_type:this.profileForm.value.customerAdminType,email:this.profileForm.value.email,contact_number:this.profileForm.value.contactNumber.internationalNumber,contact_object:JSON.stringify(this.profileForm.value.contactNumber),currency:this.profileForm.value.currency,address:this.profileForm.value.address,country_id:this.profileForm.value.country,state_id:this.profileForm.value.state,city_id:this.profileForm.value.city};this.customerAdminService.updateCustomerAdminProfile(this.data.id,t).subscribe(s=>{s.success&&(this.toastService.showSuccess("Profile updated successfully"),this.close())}),this.close()}}close(){this.modalRef&&this.modalRef.close("saved")}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(r.ok),e.rXU(_),e.rXU(F.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-update-profile"]],inputs:{mode:"mode",data:"data",modalRef:"modalRef"},decls:83,vars:67,consts:[[1,"formStyle"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["novalidate","",3,"formGroup","ngSubmit"],[1,"modal-body"],[1,"row"],[1,"col-md-6","mb-3"],[1,"text-danger"],["type","text","formControlName","customerAdminName","placeholder","Enter Customer Admin Name",1,"form-control",3,"ngClass","readonly"],["class","invalid-feedback",4,"ngIf"],["type","text","formControlName","organizationName","placeholder","Enter Organization Name",1,"form-control",3,"ngClass"],["type","text","formControlName","contactPersonName","placeholder","Enter Contact Person Name",1,"form-control",3,"ngClass"],["type","email","formControlName","email","placeholder","Enter Email",1,"form-control",3,"ngClass"],[1,"col-md-6","mb-1"],["name","phone","formControlName","contactNumber",3,"cssClass","preferredCountries","enableAutoCountrySelect","enablePlaceholder","searchCountryFlag","searchCountryField","selectFirstCountry","selectedCountryISO","separateDialCode","maxLength"],[4,"ngIf"],["type","text","formControlName","customerAdminType","placeholder","Enter Customer Admin Type",1,"form-control",3,"ngClass","readonly"],["type","text","formControlName","address","placeholder","Enter Plot No, Street Name",1,"form-control",3,"ngClass"],["bindLabel","name","bindValue","id","placeholder","Select Country","formControlName","country",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","readonly","ngModelChange"],["bindLabel","name","bindValue","id","placeholder","Select State","formControlName","state",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange"],["bindLabel","name","bindValue","id","placeholder","Select City","formControlName","city",1,"custom-currency-select",3,"items","ngModel","searchable","clearable","ngClass","ngModelChange"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"invalid-feedback"]],template:function(s,o){if(1&s&&(e.j41(0,"div",0)(1,"div",1)(2,"h5",2),e.EFF(3," Update Profile "),e.k0s(),e.j41(4,"button",3),e.bIt("click",function(){return o.close()}),e.k0s()(),e.j41(5,"form",4),e.bIt("ngSubmit",function(){return o.onSubmit()}),e.j41(6,"div",5)(7,"div",6)(8,"div",7)(9,"label"),e.EFF(10,"Customer Admin Name "),e.j41(11,"span",8),e.EFF(12,"*"),e.k0s()(),e.nrm(13,"input",9),e.DNE(14,ct,2,0,"div",10),e.k0s(),e.j41(15,"div",7)(16,"label"),e.EFF(17,"Organization Name "),e.j41(18,"span",8),e.EFF(19,"*"),e.k0s()(),e.nrm(20,"input",11),e.DNE(21,dt,2,0,"div",10),e.k0s(),e.j41(22,"div",7)(23,"label"),e.EFF(24,"Contact Person Name "),e.j41(25,"span",8),e.EFF(26,"*"),e.k0s()(),e.nrm(27,"input",12),e.DNE(28,mt,2,0,"div",10),e.k0s(),e.j41(29,"div",7)(30,"label"),e.EFF(31,"Email "),e.j41(32,"span",8),e.EFF(33,"*"),e.k0s()(),e.nrm(34,"input",13),e.DNE(35,ut,2,0,"div",10),e.k0s(),e.j41(36,"div",14)(37,"label"),e.EFF(38,"Contact Number "),e.j41(39,"span",8),e.EFF(40,"*"),e.k0s()(),e.nrm(41,"ngx-intl-tel-input",15),e.DNE(42,pt,3,0,"div",16),e.k0s(),e.j41(43,"div",7)(44,"label"),e.EFF(45,"Customer Admin Type "),e.j41(46,"span",8),e.EFF(47,"*"),e.k0s()(),e.nrm(48,"input",17),e.DNE(49,ht,2,0,"div",10),e.k0s(),e.j41(50,"div",7)(51,"label"),e.EFF(52,"Plot No, Street Name "),e.j41(53,"span",8),e.EFF(54,"*"),e.k0s()(),e.nrm(55,"input",18),e.DNE(56,gt,2,0,"div",10),e.k0s(),e.j41(57,"div",7)(58,"label"),e.EFF(59,"Country "),e.j41(60,"span",8),e.EFF(61,"*"),e.k0s()(),e.j41(62,"ng-select",19),e.bIt("ngModelChange",function(a){return o.profileForm.value.country=a}),e.k0s(),e.DNE(63,ft,2,0,"div",10),e.k0s(),e.j41(64,"div",7)(65,"label"),e.EFF(66,"State "),e.j41(67,"span",8),e.EFF(68,"*"),e.k0s()(),e.j41(69,"ng-select",20),e.bIt("ngModelChange",function(a){return o.profileForm.value.state=a}),e.k0s(),e.DNE(70,vt,2,0,"div",10),e.k0s(),e.j41(71,"div",7)(72,"label"),e.EFF(73,"City "),e.j41(74,"span",8),e.EFF(75,"*"),e.k0s()(),e.j41(76,"ng-select",21),e.bIt("ngModelChange",function(a){return o.profileForm.value.city=a}),e.k0s(),e.DNE(77,_t,2,0,"div",10),e.k0s()()(),e.j41(78,"div",22)(79,"button",23),e.bIt("click",function(){return o.close()}),e.EFF(80,"Cancel"),e.k0s(),e.j41(81,"button",24),e.EFF(82,"Update"),e.k0s()()()()),2&s){let n;e.R7$(5),e.Y8G("formGroup",o.profileForm),e.R7$(8),e.Y8G("ngClass",e.eq3(46,y,o.isFieldInvalid("customerAdminName")))("readonly",!0),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("customerAdminName")),e.R7$(6),e.Y8G("ngClass",e.eq3(48,y,o.isFieldInvalid("organizationName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("organizationName")),e.R7$(6),e.Y8G("ngClass",e.eq3(50,y,o.isFieldInvalid("contactPersonName"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("contactPersonName")),e.R7$(6),e.Y8G("ngClass",e.eq3(52,y,o.isFieldInvalid("email"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("email")),e.R7$(6),e.Y8G("cssClass","form-control")("preferredCountries",o.preferredCountries)("enableAutoCountrySelect",!1)("enablePlaceholder",!0)("searchCountryFlag",!1)("searchCountryField",e.l_i(54,bt,o.SearchCountryField.Name,o.SearchCountryField.DialCode))("selectFirstCountry",!1)("selectedCountryISO",o.selectedCountryISO)("separateDialCode",!0)("maxLength",15),e.R7$(1),e.Y8G("ngIf",(null==(n=o.profileForm.get("contactNumber"))?null:n.invalid)&&((null==(n=o.profileForm.get("contactNumber"))?null:n.touched)||o.formSubmitted)),e.R7$(6),e.Y8G("ngClass",e.eq3(57,y,o.isFieldInvalid("customerAdminType")))("readonly",!0),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("customerAdminType")),e.R7$(6),e.Y8G("ngClass",e.eq3(59,y,o.isFieldInvalid("address"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("address")),e.R7$(6),e.Y8G("items",o.countries)("ngModel",o.profileForm.value.country)("searchable",!0)("clearable",!0)("ngClass",e.eq3(61,y,o.isFieldInvalid("country")))("readonly",!0),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("country")),e.R7$(6),e.Y8G("items",o.states)("ngModel",o.profileForm.value.state)("searchable",!0)("clearable",!0)("ngClass",e.eq3(63,y,o.isFieldInvalid("state"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("state")),e.R7$(6),e.Y8G("items",o.cities)("ngModel",o.profileForm.value.city)("searchable",!0)("clearable",!0)("ngClass",e.eq3(65,y,o.isFieldInvalid("city"))),e.R7$(1),e.Y8G("ngIf",o.isFieldInvalid("city")),e.R7$(4),e.Y8G("disabled",o.profileForm.invalid)}},dependencies:[m.YU,m.bT,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,h.NA,h.ZP,g.vr]})}}return i})();const Ct=["logoutModal"];function yt(i,l){1&i&&(e.j41(0,"div",23)(1,"h3"),e.EFF(2,"Notification"),e.k0s(),e.j41(3,"div",24)(4,"div",12)(5,"label",13),e.EFF(6,"Push Notification :"),e.k0s(),e.j41(7,"p"),e.EFF(8,"Receive notifications from Rakaz on your PC."),e.k0s()(),e.j41(9,"div",25)(10,"label",26),e.EFF(11,"OFF"),e.k0s(),e.nrm(12,"input",27),e.j41(13,"label",28),e.EFF(14,"ON"),e.k0s()()()())}function kt(i,l){if(1&i&&(e.j41(0,"div",47),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.getFieldError("currentPassword")," ")}}function St(i,l){if(1&i&&(e.j41(0,"div",47),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.getFieldError("newPassword")," ")}}function Et(i,l){if(1&i&&(e.j41(0,"div",48)(1,"small",49),e.nrm(2,"i",50),e.EFF(3),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(3),e.SpI(" Password must contain: ",t.getFirstUnmetRequirement()," ")}}function Pt(i,l){1&i&&(e.j41(0,"div",51)(1,"small",52),e.nrm(2,"i",53),e.EFF(3," Password meets all requirements "),e.k0s()())}function wt(i,l){if(1&i&&(e.j41(0,"div",47),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.getFieldError("confirmPassword")," ")}}function jt(i,l){1&i&&(e.j41(0,"div",47),e.EFF(1," Passwords do not match "),e.k0s())}function It(i,l){if(1&i&&(e.j41(0,"div",54)(1,"small"),e.nrm(2,"i",55),e.EFF(3),e.k0s()()),2&i){const t=e.XpG(2);e.R7$(1),e.AVh("text-success",t.passwordsMatch())("text-danger",!t.passwordsMatch()),e.R7$(1),e.AVh("bi-check-circle-fill",t.passwordsMatch())("bi-x-circle-fill",!t.passwordsMatch()),e.R7$(1),e.SpI(" ",t.passwordsMatch()?"Passwords match":"Passwords do not match"," ")}}const I=function(i){return{"is-invalid":i}};function Nt(i,l){if(1&i){const t=e.RV6();e.j41(0,"form",29),e.bIt("ngSubmit",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.changePassword())}),e.j41(1,"div",30)(2,"div",31)(3,"div",12)(4,"label",32),e.EFF(5,"Current Password "),e.j41(6,"span",33),e.EFF(7,"*"),e.k0s()(),e.nrm(8,"input",34),e.DNE(9,kt,2,1,"div",35),e.k0s()(),e.j41(10,"div",31)(11,"div",12)(12,"label",36),e.EFF(13,"New Password "),e.j41(14,"span",33),e.EFF(15,"*"),e.k0s()(),e.nrm(16,"input",37),e.DNE(17,St,2,1,"div",35),e.DNE(18,Et,4,1,"div",38),e.DNE(19,Pt,4,0,"div",39),e.k0s()(),e.j41(20,"div",31)(21,"div",12)(22,"label",40),e.EFF(23,"Confirm Password "),e.j41(24,"span",33),e.EFF(25,"*"),e.k0s()(),e.nrm(26,"input",41),e.DNE(27,wt,2,1,"div",35),e.DNE(28,jt,2,0,"div",35),e.DNE(29,It,4,9,"div",42),e.k0s()(),e.j41(30,"div",43)(31,"div",44)(32,"button",45),e.EFF(33,"Cancel"),e.k0s(),e.j41(34,"button",46),e.EFF(35,"Submit"),e.k0s()()()()()}if(2&i){const t=e.XpG();let s,o,n,a,c;e.Y8G("formGroup",t.changePasswordForm),e.R7$(8),e.Y8G("ngClass",e.eq3(11,I,t.isFieldInvalid("currentPassword"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("currentPassword")),e.R7$(7),e.Y8G("ngClass",e.eq3(13,I,t.isFieldInvalid("newPassword"))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("newPassword")),e.R7$(1),e.Y8G("ngIf",(null==(s=t.changePasswordForm.get("newPassword"))?null:s.value)&&!t.allRequirementsMet()),e.R7$(1),e.Y8G("ngIf",(null==(o=t.changePasswordForm.get("newPassword"))?null:o.value)&&t.allRequirementsMet()),e.R7$(7),e.Y8G("ngClass",e.eq3(15,I,t.isFieldInvalid("confirmPassword")||(null==t.changePasswordForm.errors?null:t.changePasswordForm.errors.passwordMismatch)&&(null==(n=t.changePasswordForm.get("confirmPassword"))?null:n.touched))),e.R7$(1),e.Y8G("ngIf",t.isFieldInvalid("confirmPassword")),e.R7$(1),e.Y8G("ngIf",(null==t.changePasswordForm.errors?null:t.changePasswordForm.errors.passwordMismatch)&&(null==(a=t.changePasswordForm.get("confirmPassword"))?null:a.touched)&&!t.isFieldInvalid("confirmPassword")),e.R7$(1),e.Y8G("ngIf",(null==(c=t.changePasswordForm.get("confirmPassword"))?null:c.value)&&(null==(c=t.changePasswordForm.get("newPassword"))?null:c.value)&&!t.isFieldInvalid("confirmPassword")&&!(null!=t.changePasswordForm.errors&&t.changePasswordForm.errors.passwordMismatch))}}function Gt(i,l){if(1&i){const t=e.RV6();e.j41(0,"div",56)(1,"form",57)(2,"h6"),e.EFF(3,"Are you sure want to Logout?"),e.k0s()()(),e.j41(4,"div",58)(5,"button",59),e.bIt("click",function(){const n=e.eBV(t).$implicit;return e.Njj(n.close("Save click"))}),e.EFF(6,"No"),e.k0s(),e.j41(7,"button",60),e.bIt("click",function(){e.eBV(t);const o=e.XpG();return e.Njj(o.logout())}),e.EFF(8,"Yes"),e.k0s()()}}let Tt=(()=>{class i{constructor(t,s,o,n,a,c,f){this.modalService=t,this.authService=s,this.router=o,this.customerAdminService=n,this.appStateService=a,this.fb=c,this.toastService=f,this.formSubmitted=!1}ngOnInit(){this.userId=this.appStateService.getUser().user.customer_id,this.getCustomerAdminById(),this.changePasswordForm=this.fb.group({currentPassword:["",r.k0.required],newPassword:["",[r.k0.required,this.passwordStrengthValidator]],confirmPassword:["",r.k0.required]},{validators:this.passwordMatchValidator})}passwordStrengthValidator(t){const s=t.value;if(!s)return null;const o=/[A-Z]/.test(s),n=/[a-z]/.test(s),a=/[0-9]/.test(s),c=/[!@#$%^&*(),.?":{}|<>]/.test(s),u={};return s.length>=8||(u.minLength=!0),o||(u.noUpperCase=!0),n||(u.noLowerCase=!0),a||(u.noNumeric=!0),c||(u.noSpecialChar=!0),Object.keys(u).length>0?u:null}updateProfile(t,s){document.body.classList.add("modal-open-scroll-lock");const o=this.modalService.open(Ft,{centered:!0,backdrop:"static",size:"lg",windowClass:"custom-modal-class"});o.componentInstance.mode=t,o.componentInstance.data=s||null,o.componentInstance.modalRef=o,o.result.then(n=>{"saved"===n&&(console.log("Customer profile updated."),setTimeout(()=>{this.getCustomerAdminById()},80)),document.body.classList.remove("modal-open-scroll-lock")}).catch(()=>{document.body.classList.remove("modal-open-scroll-lock")})}passwordMatchValidator(t){const s=t.get("newPassword"),o=t.get("confirmPassword");return s&&o&&s.value!==o.value?{passwordMismatch:!0}:null}openModal(t,s){this.modalService.open(t,{size:s})}getCustomerAdminById(){this.customerAdminService.getCustomerAdminById(this.userId).subscribe(t=>{this.userDataForEdit=t.data,this.userData={UserId:t.data.customer_id,OrgName:t.data.organization_name,ContactPersonName:t.data.contact_person_name,CustomerAdminType:t.data.cust_admin_type,MobileNumber:t.data.contact_number,Currency:t.data.currency,Email:t.data.email,Address:t.data.address}})}logout(){this.authService.logout(),this.router.navigate(["/login"]),this.modalService.dismissAll()}isFieldInvalid(t){const s=this.changePasswordForm.get(t);return!(!s||!s.touched&&!this.formSubmitted||!s.invalid)}getFieldError(t){const s=this.changePasswordForm.get(t);if(!s||!s.errors||!s.touched&&!this.formSubmitted)return"";if(s.errors.required)return("currentPassword"===t?"Current":"newPassword"===t?"New":"Confirm")+" password is required";if("newPassword"===t){if(s.errors.minLength)return"Password must be at least 8 characters long";if(s.errors.noUpperCase)return"Password must contain at least one uppercase letter";if(s.errors.noLowerCase)return"Password must contain at least one lowercase letter";if(s.errors.noNumeric)return"Password must contain at least one number";if(s.errors.noSpecialChar)return"Password must contain at least one special character"}return""}getFirstUnmetRequirement(){const t=this.changePasswordForm.get("newPassword")?.value||"";return t?t.length<8?"At least 8 characters":/[A-Z]/.test(t)?/[a-z]/.test(t)?/[0-9]/.test(t)?/[!@#$%^&*(),.?":{}|<>]/.test(t)?"":"One special character":"One number":"One lowercase letter":"One uppercase letter":""}allRequirementsMet(){const t=this.changePasswordForm.get("newPassword")?.value||"";return t.length>=8&&/[A-Z]/.test(t)&&/[a-z]/.test(t)&&/[0-9]/.test(t)&&/[!@#$%^&*(),.?":{}|<>]/.test(t)}passwordsMatch(){return this.changePasswordForm.get("newPassword")?.value===this.changePasswordForm.get("confirmPassword")?.value}getPasswordRequirements(){const t=this.changePasswordForm.get("newPassword")?.value||"",s=[];return t.length<8&&s.push("At least 8 characters"),/[A-Z]/.test(t)||s.push("One uppercase letter"),/[a-z]/.test(t)||s.push("One lowercase letter"),/[0-9]/.test(t)||s.push("One number"),/[!@#$%^&*(),.?":{}|<>]/.test(t)||s.push("One special character"),s}hasMinLength(){return(this.changePasswordForm.get("newPassword")?.value||"").length>=8}hasUpperCase(){const t=this.changePasswordForm.get("newPassword")?.value||"";return/[A-Z]/.test(t)}hasLowerCase(){const t=this.changePasswordForm.get("newPassword")?.value||"";return/[a-z]/.test(t)}hasNumeric(){const t=this.changePasswordForm.get("newPassword")?.value||"";return/[0-9]/.test(t)}hasSpecialChar(){const t=this.changePasswordForm.get("newPassword")?.value||"";return/[!@#$%^&*(),.?":{}|<>]/.test(t)}changePassword(){if(this.formSubmitted=!0,this.changePasswordForm.markAllAsTouched(),this.changePasswordForm.invalid)return;const s={password:T.Y8(this.changePasswordForm.value.newPassword,10)};this.customerAdminService.changePassword(this.userId,s).subscribe(o=>{o.success?this.toastService.showSuccess("Password changed successfully"):this.toastService.showError("Failed to change password")},o=>{this.toastService.showError(o.error.message)})}static{this.\u0275fac=function(s){return new(s||i)(e.rXU(d.Bq),e.rXU(G.u),e.rXU(E.Ix),e.rXU(_),e.rXU(b.i),e.rXU(r.ok),e.rXU(F.f))}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-profile"]],viewQuery:function(s,o){if(1&s&&e.GBs(Ct,5),2&s){let n;e.mGM(n=e.lsd())&&(o.logoutModal=n.first)}},decls:87,vars:12,consts:[[1,"headingBlock","headingprofile"],[1,"headingprofile-left"],[1,"bi","bi-person-circle"],[2,"text-transform","capitalize"],[1,"headingprofile-right"],[1,"btn","btn-outline-primary",3,"click"],[1,"bi","bi-pencil-square"],[1,"btn","btn-primary",3,"click"],[1,"bi","bi-door-closed"],[1,"bodyContent"],[1,"row","profileRow"],[1,"col-md-6"],[1,"form-group"],["for","name"],[1,"tabBlock","profileTab"],[1,"card"],["ngbNav","",1,"nav-tabs"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink","",1,"nav-link"],["ngbNavContent",""],[1,"mt-2",3,"ngbNavOutlet"],["logoutModal",""],[1,"mt-4"],[1,"pushNotiGroup"],[1,"form-check","form-switch"],[1,"form-check-label"],["type","checkbox","id","customSwitch",1,"form-check-input"],["for","customSwitch",1,"form-check-label"],[1,"formStyle","mt-4",3,"formGroup","ngSubmit"],[1,"row","changePassGroup"],[1,"col-md-4"],["for","currentPassword"],[1,"text-danger"],["type","password","id","currentPassword","placeholder","","formControlName","currentPassword",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["for","newPassword"],["type","password","id","newPassword","placeholder","","formControlName","newPassword",1,"form-control",3,"ngClass"],["class","password-info mt-2",4,"ngIf"],["class","password-success mt-2",4,"ngIf"],["for","confirmPassword"],["type","password","id","confirmPassword","placeholder","","formControlName","confirmPassword",1,"form-control",3,"ngClass"],["class","password-match-indicator mt-1",4,"ngIf"],[1,"col-md-12","mt-2"],[1,"pull-right"],["type","button",1,"btn","btn-outline-primary"],["type","Submit",1,"btn","btn-primary"],[1,"invalid-feedback"],[1,"password-info","mt-2"],[1,"text-info"],[1,"bi","bi-info-circle"],[1,"password-success","mt-2"],[1,"text-success"],[1,"bi","bi-check-circle-fill"],[1,"password-match-indicator","mt-1"],[1,"bi"],[1,"modal-body"],[1,"formStyle","mt-2"],[1,"modal-footer","justify-content-center"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(s,o){if(1&s){const n=e.RV6();e.j41(0,"div",0)(1,"div",1),e.nrm(2,"i",2),e.j41(3,"h1",3),e.EFF(4),e.k0s()(),e.j41(5,"div",4)(6,"button",5),e.bIt("click",function(){return o.updateProfile("edit",o.userDataForEdit)}),e.nrm(7,"i",6),e.EFF(8," Edit"),e.k0s(),e.j41(9,"button",7),e.bIt("click",function(){e.eBV(n);const c=e.sdS(86);return e.Njj(o.openModal(c,"sm"))}),e.nrm(10,"i",8),e.EFF(11," Logout"),e.k0s()()(),e.j41(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12)(16,"label",13),e.EFF(17,"User ID"),e.k0s(),e.j41(18,"span"),e.EFF(19,":"),e.k0s(),e.j41(20,"h6"),e.EFF(21),e.k0s()(),e.j41(22,"div",12)(23,"label",13),e.EFF(24,"Contact Person "),e.k0s(),e.j41(25,"span"),e.EFF(26,":"),e.k0s(),e.j41(27,"h6"),e.EFF(28),e.k0s()(),e.j41(29,"div",12)(30,"label",13),e.EFF(31,"Mobile Number"),e.k0s(),e.j41(32,"span"),e.EFF(33,":"),e.k0s(),e.j41(34,"h6"),e.EFF(35),e.k0s()(),e.j41(36,"div",12)(37,"label",13),e.EFF(38,"Email"),e.k0s(),e.j41(39,"span"),e.EFF(40,":"),e.k0s(),e.j41(41,"h6"),e.EFF(42),e.k0s()()(),e.j41(43,"div",11)(44,"div",12)(45,"label",13),e.EFF(46,"Organization Name"),e.k0s(),e.j41(47,"span"),e.EFF(48,":"),e.k0s(),e.j41(49,"h6"),e.EFF(50),e.k0s()(),e.j41(51,"div",12)(52,"label",13),e.EFF(53,"Business Type "),e.k0s(),e.j41(54,"span"),e.EFF(55,":"),e.k0s(),e.j41(56,"h6"),e.EFF(57),e.k0s()(),e.j41(58,"div",12)(59,"label",13),e.EFF(60,"Currency"),e.k0s(),e.j41(61,"span"),e.EFF(62,":"),e.k0s(),e.j41(63,"h6"),e.EFF(64),e.k0s()(),e.j41(65,"div",12)(66,"label",13),e.EFF(67,"Address"),e.k0s(),e.j41(68,"span"),e.EFF(69,":"),e.k0s(),e.j41(70,"h6"),e.EFF(71),e.k0s()()()(),e.j41(72,"div",14)(73,"div",15)(74,"ul",16,17)(76,"li",18)(77,"a",19),e.EFF(78,"Settings"),e.k0s(),e.DNE(79,yt,15,0,"ng-template",20),e.k0s(),e.j41(80,"li",18)(81,"a",19),e.EFF(82,"Change Password"),e.k0s(),e.DNE(83,Nt,36,17,"ng-template",20),e.k0s()(),e.nrm(84,"div",21),e.k0s()(),e.DNE(85,Gt,9,0,"ng-template",null,22,e.C5r),e.k0s()}if(2&s){const n=e.sdS(75);e.R7$(4),e.JRh(o.userData.ContactPersonName),e.R7$(17),e.JRh(o.userData.UserId),e.R7$(7),e.JRh(o.userData.ContactPersonName),e.R7$(7),e.JRh(o.userData.MobileNumber),e.R7$(7),e.JRh(o.userData.Email),e.R7$(8),e.JRh(o.userData.OrgName),e.R7$(7),e.JRh(o.userData.CustomerAdminType),e.R7$(7),e.JRh(o.userData.Currency),e.R7$(7),e.JRh(o.userData.Address),e.R7$(5),e.Y8G("ngbNavItem",1),e.R7$(4),e.Y8G("ngbNavItem",2),e.R7$(4),e.Y8G("ngbNavOutlet",n)}},dependencies:[m.YU,m.bT,d.Um,d.X9,d.sy,d.Gx,d.Ri,d.WA,d.m_,r.qT,r.me,r.BC,r.cb,r.j4,r.JD,h.ZP,r.cV],styles:[".password-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:flex;align-items:center;color:#0dcaf0!important}.password-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.25rem;font-size:.875rem}.password-success[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:flex;align-items:center;color:#198754!important}.password-success[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.25rem;font-size:.875rem}.password-match-indicator[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{display:flex;align-items:center}.password-match-indicator[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.25rem;font-size:.75rem}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 0 .2rem #dc354540}.invalid-feedback[_ngcontent-%COMP%]{display:block;width:100%;margin-top:.25rem;font-size:.875rem;color:#dc3545}.text-success[_ngcontent-%COMP%]{color:#198754!important}.text-danger[_ngcontent-%COMP%]{color:#dc3545!important}@media (max-width: 768px){.password-requirements[_ngcontent-%COMP%]{font-size:.8rem}.password-requirements[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:.75rem}}"]})}}return i})(),At=(()=>{class i{constructor(){this.pageSize=20,this.pageSizeSelector=[10,20,50,100],this.rowHeight=40,this.columnDefs=[{field:"customerName",headerName:"Customer Name"},{field:"planName",headerName:"Plan Name"},{field:"period",headerName:"Period"},{field:"currency",headerName:"Currency"},{field:"paymentProvider",headerName:"Payment Provider"},{field:"price",headerName:"Price"},{field:"startDate",headerName:"Start Date"},{field:"expireDate",headerName:"Expire Date"}],this.defaultColDef={sortable:!0,filter:!0,resizable:!0},this.rowData=[]}ngOnInit(){this.loadDummyData()}loadDummyData(){this.rowData=[{customerName:"John Doe",planName:"Premium",period:"Monthly",currency:"USD",paymentProvider:"Stripe",price:49.99,startDate:"2025-09-01",expireDate:"2025-09-30"},{customerName:"Jane Smith",planName:"Basic",period:"Yearly",currency:"EUR",paymentProvider:"PayPal",price:199.99,startDate:"2025-01-01",expireDate:"2025-12-31"},{customerName:"Alice Johnson",planName:"Standard",period:"Monthly",currency:"GBP",paymentProvider:"Square",price:29.99,startDate:"2025-08-15",expireDate:"2025-09-14"}]}onGridReady(t){this.gridApi=t.api}onPaginationChanged(){if(!this.gridApi)return;const t=this.gridApi.paginationGetPageSize(),s=this.gridApi.paginationGetRowCount(),o=Math.min(t,s);console.log("Rows on current page:",o)}onQuickFilterChanged(t){this.gridApi&&this.gridApi.setQuickFilter(t.target.value)}onPageSizeChanged(t){console.log(t),this.gridApi&&this.gridApi.paginationSetPageSize(Number(t.target.value))}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-payments"]],decls:8,vars:6,consts:[[1,"headSection"],[1,"leftHeadSection"],[1,"rightHeadSection"],[1,"searchBlock"],[1,"bi","bi-search"],["type","text","placeholder","Search",1,"formControlSearch",3,"input"],[1,"bodyContent"],["domLayout","autoHeight",1,"ag-theme-alpine","ag-rakz-custom",2,"width","100%",3,"theme","rowData","columnDefs","defaultColDef","pagination","paginationPageSize","paginationChanged","gridReady"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.nrm(1,"div",1),e.j41(2,"div",2)(3,"div",3),e.nrm(4,"i",4),e.j41(5,"input",5),e.bIt("input",function(a){return o.onQuickFilterChanged(a)}),e.k0s()()()(),e.j41(6,"div",6)(7,"ag-grid-angular",7),e.bIt("paginationChanged",function(){return o.onPaginationChanged()})("gridReady",function(a){return o.onGridReady(a)}),e.k0s()()),2&s&&(e.R7$(7),e.Y8G("theme","legacy")("rowData",o.rowData)("columnDefs",o.columnDefs)("defaultColDef",o.defaultColDef)("pagination",!0)("paginationPageSize",o.pageSize))},dependencies:[P.xs]})}}return i})();function Dt(i,l){1&i&&e.nrm(0,"app-dashboard")}function Mt(i,l){1&i&&e.nrm(0,"app-customer-details")}function Rt(i,l){1&i&&e.nrm(0,"app-sensor-group")}function $t(i,l){1&i&&e.nrm(0,"app-sensor-grouping")}function Ut(i,l){1&i&&e.nrm(0,"app-subscriptions")}function Lt(i,l){1&i&&e.nrm(0,"app-payments")}function zt(i,l){1&i&&e.nrm(0,"app-reports")}function Yt(i,l){1&i&&e.nrm(0,"app-profile")}function qt(i,l){1&i&&(e.j41(0,"div"),e.EFF(1,"Select a module"),e.k0s())}let Ot=(()=>{class i{constructor(){this.selectedComponent={link:"",header:""}}ngOnInit(){console.log(this.selectedComponent)}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-content"]],inputs:{selectedComponent:"selectedComponent"},decls:10,vars:9,consts:[[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"]],template:function(s,o){1&s&&(e.j41(0,"div",0),e.DNE(1,Dt,1,0,"app-dashboard",1),e.DNE(2,Mt,1,0,"app-customer-details",1),e.DNE(3,Rt,1,0,"app-sensor-group",1),e.DNE(4,$t,1,0,"app-sensor-grouping",1),e.DNE(5,Ut,1,0,"app-subscriptions",1),e.DNE(6,Lt,1,0,"app-payments",1),e.DNE(7,zt,1,0,"app-reports",1),e.DNE(8,Yt,1,0,"app-profile",1),e.DNE(9,qt,2,0,"div",2),e.k0s()),2&s&&(e.Y8G("ngSwitch",o.selectedComponent.link),e.R7$(1),e.Y8G("ngSwitchCase","dashboard"),e.R7$(1),e.Y8G("ngSwitchCase","customer-details"),e.R7$(1),e.Y8G("ngSwitchCase","sensor-group"),e.R7$(1),e.Y8G("ngSwitchCase","sensor-grouping"),e.R7$(1),e.Y8G("ngSwitchCase","subscriptions"),e.R7$(1),e.Y8G("ngSwitchCase","payment-details"),e.R7$(1),e.Y8G("ngSwitchCase","reports"),e.R7$(1),e.Y8G("ngSwitchCase","profile"))},dependencies:[m.ux,m.e1,m.fG,H,Me,Be,Ve,at,lt,Tt,At]})}}return i})();const xt=[{path:"",component:(()=>{class i{constructor(){this.selectedComponent={link:"dashboard",header:"Dashboard"}}ngOnInit(){}onSidebarSelection(t){console.log(t),this.selectedComponent=t}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=e.VBU({type:i,selectors:[["app-customer-admin"]],decls:5,vars:2,consts:[[1,"admin-layout","d-flex"],[3,"linkSelected"],[1,"flex-grow-1","content-area"],[3,"selectedHeader"],[3,"selectedComponent"]],template:function(s,o){1&s&&(e.j41(0,"div",0)(1,"app-sidenav",1),e.bIt("linkSelected",function(a){return o.onSidebarSelection(a)}),e.k0s(),e.j41(2,"div",2),e.nrm(3,"app-header",3)(4,"app-content",4),e.k0s()()),2&s&&(e.R7$(3),e.Y8G("selectedHeader",o.selectedComponent),e.R7$(1),e.Y8G("selectedComponent",o.selectedComponent))},dependencies:[R,O,Ot]})}}return i})()}];let Bt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[E.iI.forChild(xt),E.iI]})}}return i})();var Vt=p(969);let Xt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=e.$C({type:i})}static{this.\u0275inj=e.G2t({imports:[m.MD,Bt,d.UN,j.q1,P.$V,d.zH,r.X1,h.s0,g.MQ,r.YN,Vt.rJ,A.z.forRoot({size:"small",color:"rgb(0, 189, 99)",switchColor:"#80FFA2",defaultBgColor:"#00ACFF",defaultBoColor:"#476EFF",checkedLabel:"on",uncheckedLabel:"off"})]})}}return i})()}}]);